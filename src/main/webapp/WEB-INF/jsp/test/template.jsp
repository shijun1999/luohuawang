(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.MarkerInfobubbles=function(){function e(e,n){this.closeInfoWindow=t(this.closeInfoWindow,this),this._addMarkerListeners=t(this._addMarkerListeners,this),this._loadMarkers=t(this._loadMarkers,this),this.setMarkers=t(this.setMarkers,this);var o,a,i;this.map=e,this.options=$.extend({},this._options,this.defaultOptions,n),this.icons={},o=this.options.sprites;for(i in o)a=o[i],this.icons[i]=new REW.MapLoadIcon(a);this._loadMarkers(),google.maps.event.addListener(this._getMap(),"click",this.closeInfoWindow)}return e.prototype.defaultOptions={},e.prototype._options={arrowStyle:0,arrowSize:15,borderRadius:0,arrowPosition:50,shadowStyle:1,autoPan:!1,defaultCenter:{lat:49.2844,lng:-123.0809},disableAutoPan:!1,minWidth:258,minHeight:230,maxWidth:258,padding:0,zIndex:1e3,hideCloseButton:!0,sprites:{},icons:{},defaultStates:{active:"active",normal:"normal"},labels:null,label:{offset:{x:0,y:0}}},e.prototype.markers=[],e.prototype.fitBounds=function(){var t,e,n,o,a,i,r;if(t=new google.maps.LatLngBounds,this.markers.length>1){for(i=this.markers,n=0,o=i.length;o>n;n++)a=i[n],t.extend(a.getPosition());this._getMap().fitBounds(t)}else null!=this.markers[0]?(e=this.markers[0].getPosition(),r=15):(e=new google.maps.LatLng(this.options.defaultCenter.lat,this.options.defaultCenter.lng),r=11),this._getMap().setCenter(e),this._getMap().setZoom(r);return this},e.prototype.resize=function(){return google.maps.event.trigger(this._getMap(),"resize"),this},e.prototype.updateMarkers=function(t){return $.getJSON(t,this.setMarkers)},e.prototype.setMarkers=function(t){var e,n,o,a,i,r;for(this._clearMarkers(),e=n=0,o=t.length;o>n;e=++n)i=t[e],r={position:new google.maps.LatLng(i.lat,i.lng),map:this._getMap(),icon:this._getIcon(i),title:i.address},a=new google.maps.Marker(r),a.data=i,this.markers.push(a);return this._addMarkerListeners(),this.fitBounds(),$(this).trigger("updated")},e.prototype._loadMarkers=function(){var t;return(t=$("[data-geocodes-url]").data("geocodes-url"))?this.updateMarkers(t):this.setMarkers($("[data-geocodes]").data("geocodes"))},e.prototype._addMarkerListeners=function(){return $.each(this.markers,function(t){return function(e,n){return google.maps.event.addListener(n,"click",function(){var e;return t.closeInfoWindow(),n.setIcon(t._getActiveIcon(n.data)),e=$(t.templates[n.data.type]($.extend({labels:t.options.labels},n.data))),e.on("click",function(t){return window.location=$(this).data("url")}),t.infoWindow=new InfoBubble($.extend(t.options,{content:e.get(0)})),t.infoWindow.marker=n,t.infoWindow.open(t._getMap(),n)})}}(this))},e.prototype._clearMarkers=function(){var t,e,n,o,a;for(o=this.markers,a=[],t=0,e=o.length;e>t;t++)n=o[t],a.push(n.setMap(null));return a},e.prototype._getIcon=function(t){return this.icons[t.type].get(this._iconType(t),this._iconState(t,this.options.defaultStates.normal))},e.prototype._getActiveIcon=function(t){return this.icons[t.type].get(this._iconType(t),this._iconState(t,this.options.defaultStates.active))},e.prototype._iconType=function(t){throw"Implemented in subclasses"},e.prototype._iconState=function(t){throw"Implemented in subclasses"},e.prototype._getMap=function(){return this.map},e.prototype.closeInfoWindow=function(){var t;return this.infoWindow?(t=this.infoWindow.marker,this.infoWindow.close(),this.infoWindow.setMap(null),t.setIcon(this._getIcon(t.data))):void 0},e}()}).call(this),function(){Handlebars.registerHelper("convertToThousands",function(t,e){return(t/1e3).toFixed(e)})}.call(this),function(){Handlebars.registerHelper("formatCurrency",function(t){return"$"+Math.round(t).toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")})}.call(this),function(){Handlebars.registerHelper("json",function(t){return JSON.stringify(t)})}.call(this),function(){Handlebars.registerHelper("truncate",function(t,e){var n,o;if(t.length>e){for(o=t.substr(0,e+1);o.length&&(n=o.substr(-1),o=o.substr(0,-1)," "!==n););return""===o&&(o=t.substr(0,e)),new Handlebars.SafeString(o+"&hellip;")}return t})}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.areamapcontrols_dropdown=Handlebars.template(function(t,e,n,o,a){function i(t,e){var o,a,i="";return i+="\n      <li>\n        <input id='assessments' name='controls' type='radio' data-table= '",(a=n.taxAssessmentTable)?o=a.call(t,{hash:{},data:e}):(a=t&&t.taxAssessmentTable,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"' data-type='fusion'/>\n        <label for=\"assessments\"> ",(a=n.taxAssessment)?o=a.call(t,{hash:{},data:e}):(a=t&&t.taxAssessment,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</label>\n      </li>\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var r,s,l="",h="function",u=this.escapeExpression,c=this;return l+='<div class="dropdown dropdown--nav dropdown--areamap" name="mapcontrol" >\n  <button class="btn btn-default btn-medium dropdown-toggle visible-xs " type="button" data-toggle="dropdown" data-type="map-menu">\n    <i class="icon-chevron-down pull-right"></i>\n    <span>',(s=n.neighbourhood)?r=s.call(e,{hash:{},data:a}):(s=e&&e.neighbourhood,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</span>\n  </button>\n  <ul class=\"dropdown-menu dropdown--areamap-select_menu\">\n    <li>\n      <input id='neighbourhood' name='controls' type='radio' data-icon='neighborhood' data-source='neighborhood' data-type='polygon' checked/>\n      <label for ='neighbourhood'> ",(s=n.neighbourhood)?r=s.call(e,{hash:{},data:a}):(s=e&&e.neighbourhood,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</label>\n    </li>\n    <li>\n      <input id=\"schools\" name='controls' type='radio' data-icon='elementaryschool'  data-source='schools' data-type='data'/>\n      <label for=\"schools\"> ",(s=n.schools)?r=s.call(e,{hash:{},data:a}):(s=e&&e.schools,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</label></li>\n    ",r=n["if"].call(e,e&&e.showAssessments,{hash:{},inverse:c.noop,fn:c.program(1,i,a),data:a}),(r||0===r)&&(l+=r),l+="\n    <li>\n      <input id='restaurants' name='controls' type='radio' data-icon='food' data-term='restaurants' data-type='yelp'/>\n      <label for=\"restaurants\"> ",(s=n.restaurants)?r=s.call(e,{hash:{},data:a}):(s=e&&e.restaurants,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</label>\n    </li>\n    <li>\n      <input  id='banks' name='controls' type='radio'data-icon='dollar' data-term='banks' data-type='yelp'/>\n      <label for=\"banks\"> ",(s=n.banks)?r=s.call(e,{hash:{},data:a}):(s=e&&e.banks,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</label>\n    </li>\n    <li>\n      <input id='coffee' name='controls' type='radio' data-icon='coffee' data-term='coffee' data-type='yelp'/>\n      <label for=\"coffee\"> ",(s=n.coffee)?r=s.call(e,{hash:{},data:a}):(s=e&&e.coffee,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</label></li>\n  </ul>\n</div>"}),this.HandlebarsTemplates.areamapcontrols_dropdown}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.assessment=Handlebars.template(function(t,e,n,o,a){function i(t,e){var o,a,i="";return i+="\n      ",(a=n.number)?o=a.call(t,{hash:{},data:e}):(a=t&&t.number,o=typeof a===c?a.call(t,{hash:{},data:e}):a),i+=p(o)+" ",(a=n.street)?o=a.call(t,{hash:{},data:e}):(a=t&&t.street,o=typeof a===c?a.call(t,{hash:{},data:e}):a),i+=p(o)+"\n    "}function r(t,e){var o,a,i,r="";return r+="\n    <dt>Land Value</dt>\n    <dd>\n      "+p((a=n.formatCurrency||t&&t.formatCurrency,i={hash:{},data:e},a?a.call(t,t&&t.land,i):d.call(t,"formatCurrency",t&&t.land,i))),o=n["if"].call(t,t&&t.isStrata,{hash:{},inverse:f.noop,fn:f.program(4,s,e),data:e}),(o||0===o)&&(r+=o),r+="\n    </dd>\n\n    <dt>Improvement Value</dt>\n    <dd>\n      "+p((a=n.formatCurrency||t&&t.formatCurrency,i={hash:{},data:e},a?a.call(t,t&&t.improvement,i):d.call(t,"formatCurrency",t&&t.improvement,i))),o=n["if"].call(t,t&&t.isStrata,{hash:{},inverse:f.noop,fn:f.program(4,s,e),data:e}),(o||0===o)&&(r+=o),r+="\n    </dd>\n\n    <dt>Total Value</dt>\n    <dd>\n      "+p((a=n.formatCurrency||t&&t.formatCurrency,i={hash:{},data:e},a?a.call(t,t&&t.total,i):d.call(t,"formatCurrency",t&&t.total,i))),o=n["if"].call(t,t&&t.isStrata,{hash:{},inverse:f.noop,fn:f.program(4,s,e),data:e}),(o||0===o)&&(r+=o),r+="\n    </dd>\n\n    <dt>Legal Type</dt>\n    <dd>",(a=n.legalType)?o=a.call(t,{hash:{},data:e}):(a=t&&t.legalType,o=typeof a===c?a.call(t,{hash:{},data:e}):a),r+=p(o)+"</dd>\n\n    <dd>\n      ",o=n["if"].call(t,t&&t.isStrata,{hash:{},inverse:f.noop,fn:f.program(6,l,e),data:e}),(o||0===o)&&(r+=o),r+="\n    </dd>\n  "}function s(t,e){return"<sup>*</sup>\n      "}function l(t,e){return"\n        <br/>\n        *unit randomly selected\n      "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var h,u="",c="function",p=this.escapeExpression,d=n.helperMissing,f=this;return u+='<dl class="infobubble infobubble--assessment">\n  <dt>Address</dt>\n  <dd>\n    ',h=n["with"].call(e,e&&e.address,{hash:{},inverse:f.noop,fn:f.program(1,i,a),data:a}),(h||0===h)&&(u+=h),u+="\n  </dd>\n\n  ",h=n["with"].call(e,e&&e.value,{hash:{},inverse:f.noop,fn:f.program(3,r,a),data:a}),(h||0===h)&&(u+=h),u+="\n</dl>"}),this.HandlebarsTemplates.assessment}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.autocomplete_category=Handlebars.template(function(t,e,n,o,a){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var i,r,s="",l="function",h=this.escapeExpression;return s+="<li class=",(r=n.categoryClass)?i=r.call(e,{hash:{},data:a}):(r=e&&e.categoryClass,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'>\n  <i class="',(r=n.categoryClass)?i=r.call(e,{hash:{},data:a}):(r=e&&e.categoryClass,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"_icon ",(r=n.categoryClass)?i=r.call(e,{hash:{},data:a}):(r=e&&e.categoryClass,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"_icon_",(r=n.itemType)?i=r.call(e,{hash:{},data:a}):(r=e&&e.itemType,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'"/>\n  ',(r=n.label)?i=r.call(e,{hash:{},data:a}):(r=e&&e.label,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"\n</li>"}),this.HandlebarsTemplates.autocomplete_category}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.autocomplete_item=Handlebars.template(function(t,e,n,o,a){function i(t,e){var o,a,i="";return i+="\n    <span class='"+h((o=t&&t.resultsClasses,o=null==o||o===!1?o:o.newRecord,typeof o===l?o.apply(t):o))+"'>",(a=n.newItem)?o=a.call(t,{hash:{},data:e}):(a=t&&t.newItem,o=typeof a===l?a.call(t,{hash:{},data:e}):a),i+=h(o)+"</span>\n  "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var r,s="",l="function",h=this.escapeExpression,u=this;return s+="<li class='"+h((r=e&&e.resultsClasses,r=null==r||r===!1?r:r.title,typeof r===l?r.apply(e):r))+"'>\n  <span>"+h((r=e&&e.item,r=null==r||r===!1?r:r.label,typeof r===l?r.apply(e):r))+"</span>\n  <span class='"+h((r=e&&e.resultsClasses,r=null==r||r===!1?r:r.subtitle,typeof r===l?r.apply(e):r))+"'>"+h((r=e&&e.item,r=null==r||r===!1?r:r.label_subtitle,typeof r===l?r.apply(e):r))+"</span>\n  ",r=n["if"].call(e,(r=e&&e.item,null==r||r===!1?r:r.is_new),{hash:{},inverse:u.noop,fn:u.program(1,i,a),data:a}),(r||0===r)&&(s+=r),s+="\n</li>\n"}),this.HandlebarsTemplates.autocomplete_item}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.building_infobubble=Handlebars.template(function(t,e,n,o,a){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var i,r,s="",l="function",h=this.escapeExpression;return s+="<article class='infobubble infobubble--large' data-url=\"",(r=n.url)?i=r.call(e,{hash:{},data:a}):(r=e&&e.url,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'">\n  <a href="',(r=n.url)?i=r.call(e,{hash:{},data:a}):(r=e&&e.url,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"\">\n    <div class='infobubble-photo'>\n      <img src='",(r=n.photo)?i=r.call(e,{hash:{},data:a}):(r=e&&e.photo,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"'>\n    </div>\n    <div class='infobubble-info'>\n      <div class='infobubble-name'>",(r=n.name)?i=r.call(e,{hash:{},data:a}):(r=e&&e.name,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"</div>\n      <div>",(r=n.address)?i=r.call(e,{hash:{},data:a}):(r=e&&e.address,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"</div>\n      <div>",(r=n.listings_count)?i=r.call(e,{hash:{},data:a}):(r=e&&e.listings_count,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"</div>\n    </div>\n  </a>\n</article>"}),this.HandlebarsTemplates.building_infobubble}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.development_infobubble=Handlebars.template(function(t,e,n,o,a){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var i,r,s="",l="function",h=this.escapeExpression;return s+="<article class='infobubble infobubble--large' data-url=\"",(r=n.url)?i=r.call(e,{hash:{},data:a}):(r=e&&e.url,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'">\n  <a href="',(r=n.url)?i=r.call(e,{hash:{},data:a}):(r=e&&e.url,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"\">\n    <div class='infobubble-photo'>\n      <img src='",(r=n.photo)?i=r.call(e,{hash:{},data:a}):(r=e&&e.photo,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"' alt='",(r=n.starting_price)?i=r.call(e,{hash:{},data:a}):(r=e&&e.starting_price,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"'>\n    </div>\n    <div class='infobubble-info'>\n      <div class='infobubble-name'>",(r=n.name)?i=r.call(e,{hash:{},data:a}):(r=e&&e.name,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"</div>\n      <div>",(r=n.address)?i=r.call(e,{hash:{},data:a}):(r=e&&e.address,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"</div>\n      <div>",(r=n.status)?i=r.call(e,{hash:{},data:a}):(r=e&&e.status,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"</div>\n    </div>\n  </a>\n</article>"}),this.HandlebarsTemplates.development_infobubble}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.inverse_captcha=Handlebars.template(function(t,e,n,o,a){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var i,r,s="",l="function",h=this.escapeExpression;return s+='<div class="checkbox">\n  <label>\n    <input type="checkbox" value="1" name="',(r=n.name)?i=r.call(e,{hash:{},data:a}):(r=e&&e.name,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'">I am not a robot\n  </label>\n</div>'}),this.HandlebarsTemplates.inverse_captcha}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.listing=Handlebars.template(function(t,e,n,o,a){function i(t,e){return"\n        <div class='propertycard-openhouse'>Open House</div>\n      "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var r,s,l="",h="function",u=this.escapeExpression,c=this;return l+="<article class='propertycard' data-url=\"",(s=n.trackable_url)?r=s.call(e,{hash:{},data:a}):(s=e&&e.trackable_url,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+'">\n  <a href="',(s=n.trackable_url)?r=s.call(e,{hash:{},data:a}):(s=e&&e.trackable_url,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"\" class='propertycard-content'>\n    <header class='propertycard-broker'>",(s=n.office)?r=s.call(e,{hash:{},data:a}):(s=e&&e.office,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</header>\n\n    <img src='",(s=n.photo_lightbox)?r=s.call(e,{hash:{},data:a}):(s=e&&e.photo_lightbox,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"' class='propertycard-image img-responsive'>\n\n    <footer>\n      <div class='propertycard-price'>",(s=n.price)?r=s.call(e,{hash:{},data:a}):(s=e&&e.price,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</div>\n\n      ",r=n["if"].call(e,e&&e.next_openhouse,{hash:{},inverse:c.noop,fn:c.program(1,i,a),data:a}),(r||0===r)&&(l+=r),l+="\n    </footer>\n  </a>\n\n  <footer class='propertycard-footer'>\n    <a href=\"",(s=n.trackable_url)?r=s.call(e,{hash:{},data:a}):(s=e&&e.trackable_url,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"\" class='propertycard-address'>",(s=n.address)?r=s.call(e,{hash:{},data:a}):(s=e&&e.address,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</a>\n\n    <ul class='propertycard-attributes'>\n      <li>"+u((r=e&&e.labels,r=null==r||r===!1?r:r.beds,typeof r===h?r.apply(e):r))+" ",(s=n.beds)?r=s.call(e,{hash:{},data:a}):(s=e&&e.beds,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</li>\n      <li>"+u((r=e&&e.labels,r=null==r||r===!1?r:r.bathrooms,typeof r===h?r.apply(e):r))+" ",(s=n.bathrooms)?r=s.call(e,{hash:{},data:a}):(s=e&&e.bathrooms,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"</li>\n      <li>",(s=n.floor_area)?r=s.call(e,{hash:{},data:a}):(s=e&&e.floor_area,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+" "+u((r=e&&e.labels,r=null==r||r===!1?r:r.square_feet,typeof r===h?r.apply(e):r))+"</li>\n    </ul>\n  </footer>\n</article>"}),this.HandlebarsTemplates.listing}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.listing_infobubble=Handlebars.template(function(t,e,n,o,a){function i(t,e){var o,a="";return a+="\n          ",o=n["with"].call(t,t&&t.next_openhouse,{hash:{},inverse:d.noop,fn:d.program(2,r,e),data:e}),(o||0===o)&&(a+=o),a+="\n        "}function r(t,e){var o,a,i="";return i+="\n            <dl class='infobubble--listing-openhouse'>\n              <dt>Open</dt>\n              <dd>\n                ",(a=n.day)?o=a.call(t,{hash:{},data:e}):(a=t&&t.day,o=typeof a===c?a.call(t,{hash:{},data:e}):a),i+=p(o)+"\n                ",(a=n.start_time)?o=a.call(t,{hash:{},data:e}):(a=t&&t.start_time,o=typeof a===c?a.call(t,{hash:{},data:e}):a),i+=p(o)+"\n                to\n                ",(a=n.end_time)?o=a.call(t,{hash:{},data:e}):(a=t&&t.end_time,o=typeof a===c?a.call(t,{hash:{},data:e}):a),i+=p(o)+"\n              </dd>\n            </dl>\n          "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var s,l,h,u="",c="function",p=this.escapeExpression,d=this,f=n.helperMissing;return u+='<div class="noscroll">\n  <article class=\'infobubble infobubble--listing\' data-url="',(l=n.url)?s=l.call(e,{hash:{},data:a}):(l=e&&e.url,s=typeof l===c?l.call(e,{hash:{},data:a}):l),u+=p(s)+'">\n    <a href="',(l=n.url)?s=l.call(e,{hash:{},data:a}):(l=e&&e.url,s=typeof l===c?l.call(e,{hash:{},data:a}):l),u+=p(s)+"\">\n      <div class='infobubble-photo'>\n          <img src='",(l=n.photo_branded)?s=l.call(e,{hash:{},data:a}):(l=e&&e.photo_branded,s=typeof l===c?l.call(e,{hash:{},data:a}):l),u+=p(s)+"'>\n          <div class='infobubble--listing-price'>",(l=n.price)?s=l.call(e,{hash:{},data:a}):(l=e&&e.price,s=typeof l===c?l.call(e,{hash:{},data:a}):l),u+=p(s)+"</div>\n      </div>\n      <div class='infobubble-info'>\n        <div class='infobubble-name'>\n          "+p((l=n.truncate||e&&e.truncate,h={hash:{},data:a},l?l.call(e,e&&e.address,23,h):f.call(e,"truncate",e&&e.address,23,h)))+"\n        </div>\n        <div class='infobubble-details'>\n          "+p((s=e&&e.labels,s=null==s||s===!1?s:s.beds,typeof s===c?s.apply(e):s))+" ",(l=n.beds)?s=l.call(e,{hash:{},data:a}):(l=e&&e.beds,s=typeof l===c?l.call(e,{hash:{},data:a}):l),u+=p(s)+",\n          "+p((s=e&&e.labels,s=null==s||s===!1?s:s.bathrooms,typeof s===c?s.apply(e):s))+" ",(l=n.bathrooms)?s=l.call(e,{hash:{},data:a}):(l=e&&e.bathrooms,s=typeof l===c?l.call(e,{hash:{},data:a}):l),u+=p(s)+",\n          ",(l=n.floor_area)?s=l.call(e,{hash:{},data:a}):(l=e&&e.floor_area,s=typeof l===c?l.call(e,{hash:{},data:a}):l),u+=p(s)+" "+p((s=e&&e.labels,s=null==s||s===!1?s:s.square_feet,typeof s===c?s.apply(e):s))+"\n        </div>\n        <div class='infobubble--listing-office'>\n          "+p((l=n.truncate||e&&e.truncate,h={hash:{},data:a},l?l.call(e,e&&e.office,25,h):f.call(e,"truncate",e&&e.office,25,h)))+"\n        </div>\n        ",s=n["if"].call(e,e&&e.next_openhouse,{hash:{},inverse:d.noop,fn:d.program(1,i,a),data:a}),(s||0===s)&&(u+=s),u+="\n      </div>\n    </a>\n  </article>\n</div>"}),this.HandlebarsTemplates.listing_infobubble}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.listing_widget=Handlebars.template(function(t,e,n,o,a){function i(t,e){return'\n      <i class="icon-rew-openhouse"></i>\n    '}function r(t,e){var o,a,i="";return i+="\n        <strong>",(a=n.beds)?o=a.call(t,{hash:{},data:e}):(a=t&&t.beds,o=typeof a===c?a.call(t,{hash:{},data:e}):a),i+=p(o)+"</strong> beds, \n      "}function s(t,e){var o,a,i="";return i+="\n        <strong>",(a=n.baths)?o=a.call(t,{hash:{},data:e}):(a=t&&t.baths,o=typeof a===c?a.call(t,{hash:{},data:e}):a),i+=p(o)+"</strong> baths\n      "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var l,h,u="",c="function",p=this.escapeExpression,d=this;return u+='<article class="rew-listing ',(h=n.backgroundClass)?l=h.call(e,{hash:{},data:a}):(h=e&&e.backgroundClass,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+'" data-id="',(h=n.mlsnum)?l=h.call(e,{hash:{},data:a}):(h=e&&e.mlsnum,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+'">\n	<div class="rew-image">\n  	<img  class="rew-listingphoto ',(h=n.banners)?l=h.call(e,{hash:{},data:a}):(h=e&&e.banners,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+'" alt="',(h=n.address)?l=h.call(e,{hash:{},data:a}):(h=e&&e.address,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+'" src="',(h=n.img)?l=h.call(e,{hash:{},data:a}):(h=e&&e.img,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+'" title="',(h=n.address)?l=h.call(e,{hash:{},data:a}):(h=e&&e.address,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+'">\n  	<span>',(h=n.displayprice)?l=h.call(e,{hash:{},data:a}):(h=e&&e.displayprice,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+"</span>\n    ",l=n["if"].call(e,e&&e.openhouse,{hash:{},inverse:d.noop,fn:d.program(1,i,a),data:a}),(l||0===l)&&(u+=l),u+='      \n\n  </div>\n\n  <ul class="rew-listingdetail">\n    <li class="rew-address">',(h=n.address)?l=h.call(e,{hash:{},data:a}):(h=e&&e.address,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+'\n    <li class="rew-area">',(h=n.area)?l=h.call(e,{hash:{},data:a}):(h=e&&e.area,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+" | \n      ",l=n["if"].call(e,e&&e.beds,{hash:{},inverse:d.noop,fn:d.program(3,r,a),data:a}),(l||0===l)&&(u+=l),u+="\n      ",l=n["if"].call(e,e&&e.baths,{hash:{},inverse:d.noop,fn:d.program(5,s,a),data:a}),(l||0===l)&&(u+=l),u+='\n    </li>\n    <li class="rew-broker"><i>',(h=n.broker)?l=h.call(e,{hash:{},data:a}):(h=e&&e.broker,l=typeof h===c?h.call(e,{hash:{},data:a}):h),u+=p(l)+"</i></li>\n  </ul>\n</article>"}),this.HandlebarsTemplates.listing_widget}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.listing_widget_detail=Handlebars.template(function(t,e,n,o,a){function i(t,e){var o,a,i="";return i+='\n          <a class="" href="'+f((o=t&&t.carousel,typeof o===d?o.apply(t):o))+'" itemprop="photo" itemscope="" itemtype="http://schema.org/Photograph">\n            <img alt="',(a=n.address)?o=a.call(t,{hash:{},data:e}):(a=t&&t.address,o=typeof a===d?a.call(t,{hash:{},data:e}):a),i+=f(o)+'" data-big="'+f((o=t&&t.image,typeof o===d?o.apply(t):o))+'" data-title="',(a=n.address)?o=a.call(t,{hash:{},data:e}):(a=t&&t.address,o=typeof a===d?a.call(t,{hash:{},data:e}):a),i+=f(o)+'" itemprop="url" src="'+f((o=t&&t.thumb,typeof o===d?o.apply(t):o))+'"/>\n          </a>\n        '}function r(t,e){var o,a,i="";return i+="\n                <li><strong>",(a=n.totalFloorArea)?o=a.call(t,{hash:{},data:e}):(a=t&&t.totalFloorArea,o=typeof a===d?a.call(t,{hash:{},data:e}):a),i+=f(o)+"</strong> Sqft</li>\n            "}function s(t,e){var o,a,i="";return i+="\n              <i class=\"icon-rew-openhouse\"></i> <a target='_blank' href='",(a=n.href)?o=a.call(t,{hash:{},data:e}):(a=t&&t.href,o=typeof a===d?a.call(t,{hash:{},data:e}):a),i+=f(o)+"'>Open House Detail Here</a>\n            "}function l(t,e){var o,a,i="";return i+='\n            <div class="rew-brokerlogo">\n                <img src="',(a=n.brokerlogo)?o=a.call(t,{hash:{},data:e}):(a=t&&t.brokerlogo,o=typeof a===d?a.call(t,{hash:{},data:e}):a),i+=f(o)+'">\n            </div>\n          '}function h(t,e){var o,a,i="";return i+='\n            <img src="',(a=n.agentimg)?o=a.call(t,{hash:{},data:e}):(a=t&&t.agentimg,o=typeof a===d?a.call(t,{hash:{},data:e}):a),i+=f(o)+'" class="rew-agentimage">\n          '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var u,c,p="",d="function",f=this.escapeExpression,g=this;return p+='<div class="modal fade" id="rewlisting" role="dialog" aria-labelledby="Listing Detail" aria-hidden="true" data-backdrop=false>\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <button class="rew-close" data-dismiss="modal" type="button">X</button>\n      <div class="rew-detailheader">\n        <span class="rew-price">',(c=n.displayprice)?u=c.call(e,{hash:{},data:a}):(c=e&&e.displayprice,u=typeof c===d?c.call(e,{hash:{},data:a}):c),p+=f(u)+'</span><span class="rew-address">',(c=n.addressfull)?u=c.call(e,{hash:{},data:a}):(c=e&&e.addressfull,u=typeof c===d?c.call(e,{hash:{},data:a}):c),p+=f(u)+'</span>\n      </div>\n\n      <div class="photogallery gallery">\n        ',u=n.each.call(e,e&&e.combinedimages,{hash:{},inverse:g.noop,fn:g.program(1,i,a),data:a}),(u||0===u)&&(p+=u),p+='\n      </div>\n\n\n      <div class="rew-detail">\n        <div class="rew-detailinfo">\n          <ul >\n            <li><strong>',(c=n.beds)?u=c.call(e,{hash:{},data:a}):(c=e&&e.beds,u=typeof c===d?c.call(e,{hash:{},data:a}):c),p+=f(u)+"</strong> Beds <strong>",(c=n.baths)?u=c.call(e,{hash:{},data:a}):(c=e&&e.baths,u=typeof c===d?c.call(e,{hash:{},data:a}):c),p+=f(u)+"</strong> Baths</li>\n            ",u=n["if"].call(e,e&&e.totalFloorArea,{hash:{},inverse:g.noop,fn:g.program(3,r,a),data:a}),(u||0===u)&&(p+=u),p+='\n            <li class="rew-mlsinfo">MLS ID: ',(c=n.mlsnum)?u=c.call(e,{hash:{},data:a}):(c=e&&e.mlsnum,u=typeof c===d?c.call(e,{hash:{},data:a}):c),p+=f(u)+"</li>\n\n            ",u=n["if"].call(e,e&&e.openhouse,{hash:{},inverse:g.noop,fn:g.program(5,s,a),data:a}),(u||0===u)&&(p+=u),p+='\n          </ul>\n        </div>\n\n        <div class="rew-agentcontainer">\n          ',u=n["if"].call(e,e&&e.isenhanced,{hash:{},inverse:g.noop,fn:g.program(7,l,a),data:a}),(u||0===u)&&(p+=u),p+="\n          ",u=n["if"].call(e,e&&e.agentimg,{hash:{},inverse:g.noop,fn:g.program(9,h,a),data:a}),(u||0===u)&&(p+=u),p+='\n          <div class="rew-agentinfo">\n            <ul>\n              <li class="rew-agentname">',(c=n.agents)?u=c.call(e,{hash:{},data:a}):(c=e&&e.agents,u=typeof c===d?c.call(e,{hash:{},data:a}):c),p+=f(u)+'</li>\n              <li class="rew-agentbroker">',(c=n.broker)?u=c.call(e,{hash:{},data:a}):(c=e&&e.broker,u=typeof c===d?c.call(e,{hash:{},data:a}):c),p+=f(u)+"</li>\n              <li class=\"rew-contactagent\"><a target='_blank' href='",(c=n.agentContactUrl)?u=c.call(e,{hash:{},data:a}):(c=e&&e.agentContactUrl,u=typeof c===d?c.call(e,{hash:{},data:a}):c),p+=f(u)+"'>Contact Agent</a></li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n\n      <div class=\"rew-footer\">\n        <a target='_blank' href='",(c=n.href)?u=c.call(e,{hash:{},data:a}):(c=e&&e.href,u=typeof c===d?c.call(e,{hash:{},data:a}):c),p+=f(u)+"'><span class='rew-poweredby'>View Full Listing on </span> <img class=\"rewlogo-small\" src='http://www.rew.ca/assets/logo.png'></a>\n      </div>\n    </div>\n  </div>\n</div>"}),this.HandlebarsTemplates.listing_widget_detail}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.listing_widget_disclaimer=Handlebars.template(function(t,e,n,o,a){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{},'<div class="rew-mls">\n  <img alt="MLS Reciprocity Logo" src="http://www.rew.ca/assets/reb_logo_property.png" class="rew-mlsimage">\n  <p class="rew-disclaimer">\n    This representation is based in whole or in part on data generated by the Chilliwack &amp; District Real Estate Board, Fraser Valley Real Estate Board or Real Estate Board of Greater Vancouver which assumes no responsibility for its accuracy.\n  </p>\n</div>'}),this.HandlebarsTemplates.listing_widget_disclaimer}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.map_actions=Handlebars.template(function(t,e,n,o,a){function i(t,e){var o,a,i="";return i+='\n      <li><a href="#">',(a=n.title)?o=a.call(t,{hash:{},data:e}):(a=t&&t.title,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</a></li>\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var r,s,l="",h="function",u=this.escapeExpression,c=this;return l+='<div class="mapactionspopup">\n  <header>\n    ',(s=n.location)?r=s.call(e,{hash:{},data:a}):(s=e&&e.location,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+"\n  </header>\n  <p>",(s=n.count)?r=s.call(e,{hash:{},data:a}):(s=e&&e.count,r=typeof s===h?s.call(e,{hash:{},data:a}):s),l+=u(r)+' Open Houses Available</p>\n  <ul class="list-unstyled clearfix">\n    ',r=n.each.call(e,e&&e.actions,{hash:{},inverse:c.noop,fn:c.program(1,i,a),data:a}),(r||0===r)&&(l+=r),l+="\n  </ul>\n</div>"}),this.HandlebarsTemplates.map_actions}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.map_maximizer=Handlebars.template(function(t,e,n,o,a){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{},"<div class='mapbutton maximizer'>\n  <a class='maximizer-maximize' href='#'><i class=\"icon-tiny-maximize-dark\"></i> Full</a>\n  <a class='maximizer-minimize' href='#'><i class=\"icon-tiny-minimize-dark\"></i> Small</a>\n</div>"}),this.HandlebarsTemplates.map_maximizer}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.map_search_button=Handlebars.template(function(t,e,n,o,a){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var i,r,s="",l="function",h=this.escapeExpression;return s+="<div class='mapbutton'>\n  <a href=\"",(r=n.url)?i=r.call(e,{hash:{},data:a}):(r=e&&e.url,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'">View Full Map</a>\n</div>'}),this.HandlebarsTemplates.map_search_button}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.mapcontrols=Handlebars.template(function(t,e,n,o,a){function i(t,e){return"propertymap-controls_narrow"}function r(t,e){return"is-hidden"}function s(t,e){return"is-collapsed"}function l(t,e){return"in"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var h,u,c="",p=this,d="function",f=this.escapeExpression;return c+="<div class='propertymap-controls ",h=n["if"].call(e,e&&e.narrow,{hash:{},inverse:p.noop,fn:p.program(1,i,a),data:a}),(h||0===h)&&(c+=h),c+=" pulltab pulltab--",(u=n.direction)?h=u.call(e,{hash:{},data:a}):(u=e&&e.direction,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+" ",h=n.unless.call(e,e&&e.isOpen,{hash:{},inverse:p.noop,fn:p.program(3,r,a),data:a}),(h||0===h)&&(c+=h),c+="'>\n  <div class='pulltab-inner'>\n    <div class='pulltab-handle propertymap-controls_highlight'>\n      <div class='pulltab-handle_open'>\n        <span class='pulltab-handle_label'>",(u=n.open)?h=u.call(e,{hash:{},data:a}):(u=e&&e.open,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+"</span> <i class=\"icon pulltab-handle_icon\"></i>\n      </div>\n      <div class='pulltab-handle_close'>\n        <span class='pulltab-handle_label'>",(u=n.close)?h=u.call(e,{hash:{},data:a}):(u=e&&e.close,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+"</span> <i class=\"icon pulltab-handle_icon\"></i>\n      </div>\n    </div>\n    <div class='pulltab-content'>\n      <div class='propertymap-controls_inner'>\n        <div class=\"propertymap-controls_help\">",(u=n.help)?h=u.call(e,{hash:{},data:a}):(u=e&&e.help,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+'</div>\n        <div class="propertymap-controls_toggle propertymap-controls_highlight" data-toggle="collapse" data-target="#layers">\n          <i id="layersCollapseIcon" class="icon icon-collapse propertymap-controls_toggle_icon ',
h=n.unless.call(e,(h=e&&e.expand,null==h||h===!1?h:h.layers),{hash:{},inverse:p.noop,fn:p.program(5,s,a),data:a}),(h||0===h)&&(c+=h),c+='"></i>\n          ',(u=n.layers)?h=u.call(e,{hash:{},data:a}):(u=e&&e.layers,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+'\n        </div>\n        <div id="layers" class="collapse ',h=n["if"].call(e,(h=e&&e.expand,null==h||h===!1?h:h.layers),{hash:{},inverse:p.noop,fn:p.program(7,l,a),data:a}),(h||0===h)&&(c+=h),c+="\">\n          <ul class='list-unstyled propertymap-controls_layers'>\n            <li>\n              <div class=\"checkbox\">\n                <label for='elementary'>\n                  <input data-icon='elementaryschool' data-type='kml' data-url='http://data.vancouver.ca/download/kml/elementary_school_boundaries.kmz' id='elementary' data-category='Elementary' type='checkbox'>",(u=n.elementarySchools)?h=u.call(e,{hash:{},data:a}):(u=e&&e.elementarySchools,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+"</input>\n                </label>\n              </div>\n            </li>\n            <li>\n              <div class=\"checkbox\">\n                <label for='secondary'>\n                  <input data-icon='secondaryschool' data-type='kml' data-url='http://data.vancouver.ca/download/kml/secondary_school_boundaries.kmz' id='secondary'  data-category='Secondary' type='checkbox'>",(u=n.secondarySchools)?h=u.call(e,{hash:{},data:a}):(u=e&&e.secondarySchools,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+"</input>\n                </label>\n              </div>\n            </li>\n            <li>\n              <div class=\"checkbox\">\n                <label for='taxAssessment'>\n                  <input data-type='fusion' data-table= '",(u=n.taxAssessmentTable)?h=u.call(e,{hash:{},data:a}):(u=e&&e.taxAssessmentTable,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+"' id='taxAssessment' type='checkbox'>",(u=n.taxAssessment)?h=u.call(e,{hash:{},data:a}):(u=e&&e.taxAssessment,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+'</input>\n                </label>\n              </div>\n            </li>\n          </ul>\n        </div>\n        <div class="propertymap-controls_toggle propertymap-controls_highlight" data-toggle="collapse" data-target="#amenities">\n          <i id="amenitiesCollapseIcon"class="icon icon-collapse propertymap-controls_toggle_icon ',h=n.unless.call(e,(h=e&&e.expand,null==h||h===!1?h:h.amenities),{hash:{},inverse:p.noop,fn:p.program(5,s,a),data:a}),(h||0===h)&&(c+=h),c+='"></i>\n          ',(u=n.amenities)?h=u.call(e,{hash:{},data:a}):(u=e&&e.amenities,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+'\n        </div>\n        <div id="amenities" class="collapse ',h=n["if"].call(e,(h=e&&e.expand,null==h||h===!1?h:h.amenities),{hash:{},inverse:p.noop,fn:p.program(7,l,a),data:a}),(h||0===h)&&(c+=h),c+="\">\n          <ul class='list-unstyled propertymap-controls_layers'>\n            <li>\n              <div class=\"checkbox\">\n                <label for='restaurants'>\n                  <input data-icon='food' data-term='restaurants' data-type='yelp' id='restaurants' type='checkbox'>",(u=n.restaurants)?h=u.call(e,{hash:{},data:a}):(u=e&&e.restaurants,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+"</input>\n                </label>\n              </div>\n            </li>\n            <li>\n              <div class=\"checkbox\">\n                <label for='banks'>\n                  <input data-icon='dollar' data-term='banks' data-type='yelp' id='banks' type='checkbox'>",(u=n.banks)?h=u.call(e,{hash:{},data:a}):(u=e&&e.banks,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+"</input>\n                </label>\n              </div>\n            </li>\n            <li>\n              <div class=\"checkbox\">\n                <label for='coffee'>\n                  <input data-icon='coffee' data-term='coffee' data-type='yelp' id='coffee' type='checkbox'>",(u=n.coffee)?h=u.call(e,{hash:{},data:a}):(u=e&&e.coffee,h=typeof u===d?u.call(e,{hash:{},data:a}):u),c+=f(h)+"</input>\n                </label>\n              </div>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>"}),this.HandlebarsTemplates.mapcontrols}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.notifications=Handlebars.template(function(t,e,n,o,a){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var i,r,s="",l="function",h=this.escapeExpression;return s+='<div class="alert alert-',(r=n.type)?i=r.call(e,{hash:{},data:a}):(r=e&&e.type,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+' fade in">\n  <a class="close" data-dismiss="alert" href="#">&times;</a>\n  <i class="alert-icon icon-flash-',(r=n.type)?i=r.call(e,{hash:{},data:a}):(r=e&&e.type,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'"></i>\n  <div class="alert-text">\n    ',(r=n.body)?i=r.call(e,{hash:{},data:a}):(r=e&&e.body,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"\n  </div>\n</div>"}),this.HandlebarsTemplates.notifications}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.out_of_bounds_modal=Handlebars.template(function(t,e,n,o,a){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{},'<div class="modal modal--rew fade">\n  <div class="modal-dialog modal-sm">\n  \n    <div class="modal-content helpscreen">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal">&times;</button>\n        <div class="modal-title">\n          No Results Found\n        </div>\n      </div>\n\n      <div class="modal-body helpscreen-body">\n        <div class="helpscreen-title">\n          0 Results\n        </div>\n        <div class="helpscreen-caption">\n          <p>Sorry, there are no listings available in this location.</p>\n          <p>Enter a new search or search by neighbourhood.</p>\n        </div>\n        <div class="helpscreen-link">\n          <a class="btn btn--charcoal btn-block helpscreen-button" href="/sitemap/real-estate ">\n            Search by Neighbourhood\n          </a>\n        </div>\n      </div>\n\n      <div class="modal-footer">\n        <div class="helpscreen-button btn btn-info btn-block"  data-dismiss="modal">\n          Proceed to map\n        </div>\n        <label class="helpscreen-checkbox">\n          <input type="checkbox" value="0" data-helpscreen-checkbox=true></input>\n          Don\'t show again\n        </label>\n      </div>\n\n    </div>\n  </div>\n</div>'}),this.HandlebarsTemplates.out_of_bounds_modal}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.school_infobubble=Handlebars.template(function(t,e,n,o,a){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var i,r,s="",l="function",h=this.escapeExpression;return s+="<article class='infobubble infobubble--school'>\n  <header>",(r=n.name)?i=r.call(e,{hash:{},data:a}):(r=e&&e.name,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'</header>\n  <div class="infobubble--school-content">\n    <a href=',(r=n.url)?i=r.call(e,{hash:{},data:a}):(r=e&&e.url,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+' target="_blank">',(r=n.url)?i=r.call(e,{hash:{},data:a}):(r=e&&e.url,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"</a>\n    <div>",(r=n.phone)?i=r.call(e,{hash:{},data:a}):(r=e&&e.phone,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"</div>\n  </div>\n  <footer>Category: ",(r=n.category)?i=r.call(e,{hash:{},data:a}):(r=e&&e.category,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+"</footer>\n</article>"}),this.HandlebarsTemplates.school_infobubble}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.schools_table=Handlebars.template(function(t,e,n,o,a){function i(t,e){var o,a,i="";return i+='\n      <th colspan="2">',(a=n.school)?o=a.call(t,{hash:{},data:e}):(a=t&&t.school,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</th>\n      <th>",(a=n.grades)?o=a.call(t,{hash:{},data:e}):(a=t&&t.grades,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</th>\n      <th>",(a=n.category)?o=a.call(t,{hash:{},data:e}):(a=t&&t.category,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</th>\n    "}function r(t,e){var o,a,i="";return i+='\n    <tr id="'+u((o=null==e||e===!1?e:e.index,typeof o===h?o.apply(t):o))+'">\n      <td colspan="2">',(a=n.name)?o=a.call(t,{hash:{},data:e}):(a=t&&t.name,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</td>\n      <td>",(a=n.grades)?o=a.call(t,{hash:{},data:e}):(a=t&&t.grades,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</td>\n      <td>",(a=n.category)?o=a.call(t,{hash:{},data:e}):(a=t&&t.category,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</td>\n    </tr>\n  "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var s,l="",h="function",u=this.escapeExpression,c=this;return l+="<thead>\n  <tr>\n    ",s=n["with"].call(e,e&&e.labels,{hash:{},inverse:c.noop,fn:c.program(1,i,a),data:a}),(s||0===s)&&(l+=s),l+="\n  </tr>\n</thead>\n<tbody>\n  ",s=n.each.call(e,e&&e.data,{hash:{},inverse:c.noop,fn:c.program(3,r,a),data:a}),(s||0===s)&&(l+=s),l+="\n</tbody>"}),this.HandlebarsTemplates.schools_table}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.search_location=Handlebars.template(function(t,e,n,o,a){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var i,r,s="",l="function",h=this.escapeExpression;return s+="<li class='filtertag' data-geography_id=\"",(r=n.id)?i=r.call(e,{hash:{},data:a}):(r=e&&e.id,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'">\n  ',(r=n.name)?i=r.call(e,{hash:{},data:a}):(r=e&&e.name,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'\n  <a href="#"><i class="icon-xsmall icon-remove"></i></a>\n  <input type="hidden" name="property_search[geographies][]" value="',(r=n.id)?i=r.call(e,{hash:{},data:a}):(r=e&&e.id,i=typeof r===l?r.call(e,{hash:{},data:a}):r),s+=h(i)+'" />\n</li>'}),this.HandlebarsTemplates.search_location}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.yelp_infobubble=Handlebars.template(function(t,e,n,o,a){function i(t,e){var o,a,i="";return i+='\n    <div class="media-image">\n      <img class="media--yelp-photo" src="',(a=n.image_url)?o=a.call(t,{hash:{},data:e}):(a=t&&t.image_url,o=typeof a===u?a.call(t,{hash:{},data:e}):a),i+=c(o)+'">\n      <img class="media--yelp-logo" src="https://d3ljd161w9lywl.cloudfront.net/assets/yelp-cc70a30b7ad4c2549c13c008a6bff643.png" alt="Yelp">\n    </div>\n    '}function r(t,e){var n="";return n+="\n        <li>"+c(typeof t===u?t.apply(t):t)+"</li>\n        "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var s,l,h="",u="function",c=this.escapeExpression,p=this;return h+="<article class='infobubble'>\n  <div class=\"media media--yelp\">\n    ",s=n["if"].call(e,e&&e.image_url,{hash:{},inverse:p.noop,fn:p.program(1,i,a),data:a}),(s||0===s)&&(h+=s),h+='\n    <section class="media-content">\n      <header>',(l=n.name)?s=l.call(e,{hash:{},data:a}):(l=e&&e.name,s=typeof l===u?l.call(e,{hash:{},data:a}):l),h+=c(s)+"</header>\n      <div class='media--yelp-rating'>\n        <img src='",(l=n.rating_img_url)?s=l.call(e,{hash:{},data:a}):(l=e&&e.rating_img_url,s=typeof l===u?l.call(e,{hash:{},data:a}):l),h+=c(s)+"'>\n        <a href='",(l=n.url)?s=l.call(e,{hash:{},data:a}):(l=e&&e.url,s=typeof l===u?l.call(e,{hash:{},data:a}):l),h+=c(s)+"' target='_blank'>",(l=n.review_count)?s=l.call(e,{hash:{},data:a}):(l=e&&e.review_count,s=typeof l===u?l.call(e,{hash:{},data:a}):l),h+=c(s)+" reviews</a>\n      </div>\n      <div>",(l=n.address)?s=l.call(e,{hash:{},data:a}):(l=e&&e.address,s=typeof l===u?l.call(e,{hash:{},data:a}):l),h+=c(s)+'</div>\n      <ul class="l-commalist">\n        ',s=n.each.call(e,e&&e.neighborhoods,{hash:{},inverse:p.noop,fn:p.program(3,r,a),data:a}),(s||0===s)&&(h+=s),h+="\n      </ul>\n      <div>",(l=n.phone)?s=l.call(e,{hash:{},data:a}):(l=e&&e.phone,s=typeof l===u?l.call(e,{hash:{},data:a}):l),h+=c(s)+"</div>\n    </section>\n  </div>\n</article>"}),this.HandlebarsTemplates.yelp_infobubble}.call(this),function(){return this.HandlebarsTemplates||(this.HandlebarsTemplates={}),this.HandlebarsTemplates.yelp_table=Handlebars.template(function(t,e,n,o,a){function i(t,e){var o,a,i="";return i+='\n      <th colspan="2">',(a=n.business)?o=a.call(t,{hash:{},data:e}):(a=t&&t.business,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</th>\n      <th>",(a=n.rating)?o=a.call(t,{hash:{},data:e}):(a=t&&t.rating,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</th>\n      <th>",(a=n.distance)?o=a.call(t,{hash:{},data:e}):(a=t&&t.distance,o=typeof a===h?a.call(t,{hash:{},data:e}):a),i+=u(o)+"</th>\n    "}function r(t,e){var o,a,i,r="";return r+='\n      <tr id="'+u((o=null==e||e===!1?e:e.index,typeof o===h?o.apply(t):o))+'">\n        <td colspan="2">',(a=n.name)?o=a.call(t,{hash:{},data:e}):(a=t&&t.name,o=typeof a===h?a.call(t,{hash:{},data:e}):a),r+=u(o)+"</td>\n        <td><img src='",(a=n.rating_img_url)?o=a.call(t,{hash:{},data:e}):(a=t&&t.rating_img_url,o=typeof a===h?a.call(t,{hash:{},data:e}):a),r+=u(o)+"'></td>\n        <td>"+u((a=n.convertToThousands||t&&t.convertToThousands,i={hash:{},data:e},a?a.call(t,t&&t.distance,1,i):c.call(t,"convertToThousands",t&&t.distance,1,i)))+" km</td>\n      </tr>\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),a=a||{};var s,l="",h="function",u=this.escapeExpression,c=n.helperMissing,p=this;return l+="<thead>\n  <tr>\n    ",s=n["with"].call(e,e&&e.labels,{hash:{},inverse:p.noop,fn:p.program(1,i,a),data:a}),(s||0===s)&&(l+=s),l+="\n  </tr>\n</thead>\n<tbody>\n    ",s=n.each.call(e,e&&e.data,{hash:{},inverse:p.noop,fn:p.program(3,r,a),data:a}),(s||0===s)&&(l+=s),l+="\n</tbody>"}),this.HandlebarsTemplates.yelp_table}.call(this),function(){null==window.REW&&(window.REW={}),REW.Accordion=function(){function t(t,e){this.$label=$(t),this.$indicator=$(e),this._attachEvents()}return t.prototype._attachEvents=function(){return this.$label.on("click",function(t){return function(e){return t.$label.hasClass("collapsed")?t.$indicator.html("-"):t.$indicator.html("+")}}(this))},t}(),$(function(){return new REW.Accordion(".accordion-link_label",".accordion-link_indicator")})}.call(this),function(){null==window.REW&&(window.REW={}),REW.AdRefresher={refresh:function(){return null!=("undefined"!=typeof googletag&&null!==googletag?googletag.pubads:void 0)?googletag.pubads().refresh():void 0}}}.call(this),function(){null==window.REW&&(window.REW={}),REW.AjaxFormSubmitter=function(){function t(t,e){this.options={onBeforeData:function(){},onBeforeSend:function(){},onSuccess:function(){},onError:function(){}},this.$form=$(t),$.extend(this.options,e),this.$form.data("submitter",this).on("submit",function(t){return function(e){var n,o;return e.preventDefault(),n=$(e.target),t.options.onBeforeData(),o=n.serialize(),$.ajax(n.attr("action"),{type:"POST",data:o,beforeSend:function(){return t.options.onBeforeSend()},success:t.options.onSuccess,error:function(e,n,o){var a;return a=JSON.parse(e.responseText),o=a.error,t.options.onError(o,a)},dataType:"json"})}}(this))}return t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.AjaxFormSubmitterWithErrorHandling=function(){function t(t,e){var n,o,a,i;e=$.extend({},this.options,e),o=$(t),n=e.errorHolder?o.find(e.errorHolder):o,a=e.successHolder?o.find(e.successHolder):null,i=a?{container:a}:null,new REW.AjaxFormSubmitter(o,{onBeforeData:e.onBeforeData,onBeforeSend:function(t){return function(){return o.find(".help-block, .alert").remove(),o.find(".form-group").removeClass("error"),e.onBeforeSend()}}(this),onSuccess:function(t){return function(t){return new REW.Notification("success",t.message,i),e.successEvent&&REW.Tracking[e.successEvent](),e.onSuccess()}}(this),onError:function(t){return function(t,a){var i,r,s,l;l=a.errors;for(s in l)t=l[s],i=o.find('[name$="['+s+']"]'),r=i.parents(".form-group"),r.addClass("error"),i.after('<div class="help-block">'+t+"</div>");return a.errors.base&&n.prepend("<div class='alert alert-danger'>"+a.errors.base+"</div>"),e.onFailure()}}(this)})}return t.prototype.options={errorHolder:null,successHolder:null,onBeforeData:function(){},onBeforeSend:function(){},onSuccess:function(){},onFailure:function(){},successEvent:null},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.AJAXInfoBubble=function(){function t(t){this.options=$.extend(this.options,t),this._build()}return t.prototype.options={url:null,template:null,map:null,marker:null,autoOpen:!0,defaults:{},bubbleOptions:{}},t.prototype._build=function(){return $.getJSON(this.options.url,function(t){return function(e){return t._buildInfoBubble($.extend(t.options.defaults,e)),t.options.autoOpen?t.open():void 0}}(this))},t.prototype._buildInfoBubble=function(t){var e,n,o;return n=this.options.template(t),e={content:n,minWidth:250,minHeight:90,maxHeight:180,maxWidth:250,paddding:10,borderRadius:0,arrowStyle:0,arrowPosition:50,arrowSize:15,shadowStyle:0,disableAutoPan:!1},o=$.extend({},e,this.options.bubbleOptions),this.infoBubble=new InfoBubble(o)},t.prototype.open=function(){return this.infoBubble?this.infoBubble.open(this.options.map,this.options.marker):void 0},t.prototype.close=function(){return this.infoBubble?this.infoBubble.close():void 0},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.AjaxLinkHandler=function(){function e(e){this.handleResponse=t(this.handleResponse,this),this.submit=t(this.submit,this),this.$el=$(e),this.$el.on("click","a",function(t){return function(e){return e.preventDefault(),void REW.LoginHandler.loginAndProcess(t.submit)}}(this))}return e.prototype.submit=function(){var t,e,n;return t=this.$el.find("a"),n=t.attr("href"),e=t.data("ajax-method")||t.data("method"),$.ajax({url:n,data:this.data(t),type:e}).done(function(t){return function(e,n,o){return t.handleResponse(o)}}(this)).fail(function(t){return function(e,n){return t.handleResponse(e)}}(this))},e.prototype.data=function(t){return{}},e.prototype.handleResponse=function(t){var e,n;return n=$.parseJSON(t.responseText),e=$(HandlebarsTemplates.notifications({type:n.flash,body:n.message})),$("[data-notifications-bar]").append(e),this.$el.html(n.update),window.setTimeout(function(){return e.alert("close")},5e3)},e}()}.call(this),function(){var t=function(t,n){function o(){this.constructor=t}for(var a in n)e.call(n,a)&&(t[a]=n[a]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t},e={}.hasOwnProperty;null==window.REW&&(window.REW={}),REW.AlertSearchHandler=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.data=function(t){return{button_id:t.data("button-id"),search_type:t.data("search-type"),search_id:t.data("search-id")}},n}(REW.AjaxLinkHandler),$(function(){return $("[data-alerthandler]").each(function(t,e){return new REW.AlertSearchHandler("#"+e.id)})})}.call(this),function(){null==window.REW&&(window.REW={}),REW.AlertStateToggle=function(){function t(){}return t.setState=function(t,e,n){var o;return o={state:e,_method:"PUT"},$.post(t,o,n,"json")},t}(),$(function(){return $("[data-alerttoggle]").on("change",function(t){var e,n,o;return e=$(this),o=e.data("url"),n=e.prop("checked")?"activate":"deactivate",REW.AlertStateToggle.setState(o,n,function(){})})})}.call(this),function(){null==window.REW&&(window.REW={}),REW.AttachmentButtons=function(){function t(t,e){this.$el=$(t),$.extend(this.options,e),this.$inputField=this.$el.find(".attachmentbuttons-input"),this.$removeButton=this.$el.find(".attachmentbuttons-remove"),this.$removeField=this.$el.find(".attachmentbuttons-destroy"),this.$progressBar=this.$el.find(".attachmentbuttons-progress"),this.$fileSize=this.$el.find(".attachmentbuttons-file_size"),this.format=this.$el.find(".attachmentbuttons-file_format"),this.$inputField.on("change",function(t){return function(e){return t.$removeField.val("false")}}(this)).on("cloudinarydone",function(t){return function(e,n){return t.$fileSize.val(n.result.bytes),t.format.val(n.result.format),t.$el.trigger("imageChanged",n.result)}}(this)).on("fileuploadsend",function(t){return function(e){return t.$progressBar.removeClass("hidden"),t.$el.find(".cloudinary-fileupload").hide()}}(this)).on("fileuploadprogress",function(t){return function(e,n){var o;return o=Math.round(100*n.loaded/n.total)+"%",t.$progressBar.find(".attachmentbuttons-progress_bar").css({width:o}),t.$progressBar.find(".attachmentbuttons-progress_label").html(o)}}(this)).on("fileuploadalways",function(t){return function(e){return t.$progressBar.addClass("hidden"),t.$removeButton.show()}}(this)),this.$removeButton.click(function(t){return function(e){return e.preventDefault(),t.$inputField.val(""),t.$el.find(".cloudinary-fileupload").show(),t.$removeButton.hide(),t.$removeField.val("true"),t.$el.trigger("removeAttachment")}}(this))}return t.prototype.options={},t}(),$(function(){return $(".attachmentbuttons").each(function(){return $.data(this,"attachmentButtons")?void 0:$.data(this,"attachmentButtons",new REW.AttachmentButtons(this))})})}.call(this),function(){null==window.REW&&(window.REW={}),REW.BannerNavLoader={load:function(){return $(".banner-nav").load("/navigation/show")}},$(function(){return REW.BannerNavLoader.load()})}.call(this),function(){null==window.REW&&(window.REW={}),REW.BookmarkButtonUpdater=function(){function t(t){this.options=$.extend(this.options,t),this.options.bookmarks.length>0&&$("[data-bookmarkable-id]").each(function(t){return function(e,n){var o,a;return o=$(n),a=parseInt(o.data("bookmarkable-id"),10),t._hasBookmark(a)?o.attr("href","/bookmarks/"+a+"/deactivate").data("ajax-method","put").data("track-event","unbookmarkProperty").addClass("is-active"):void 0}}(this)),this.options.showButtons&&$("[data-bookmarkable]").removeClass("hidden")}return t.prototype.options={bookmarks:[],showButtons:!0},t.prototype._hasBookmark=function(t){return-1!==this.options.bookmarks.indexOf(t)},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function o(){this.constructor=t}for(var a in e)n.call(e,a)&&(t[a]=e[a]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;null==window.REW&&(window.REW={}),REW.BookmarkHandler=function(n){function o(){return this.handleResponse=t(this.handleResponse,this),o.__super__.constructor.apply(this,arguments)}return e(o,n),o.prototype.data=function(t){return{button_id:t.data("button-id"),bookmarkable_id:t.data("bookmarkable-id"),bookmarkable_type:t.data("bookmarkable-type")}},o.prototype.handleResponse=function(t){var e;return e=$.parseJSON(t.responseText),this.$el.html(e.update)},o}(REW.AjaxLinkHandler)}.call(this),function(){null==window.REW&&(window.REW={}),REW.BucketCollector=function(){function t(t){this.rows=t}return t.prototype.range=function(){var t;return t=this.rows.sort(function(t,e){return t[1]-e[1]}),[parseInt(t[0][1],10),parseInt(t[t.length-1][1],10)]},t.prototype.steps=function(t){var e,n,o,a,i,r;for(null==t&&(t=5),a=this.range(),n=(a[1]-a[0])/t,r=[],e=o=1,i=t;i>=1?i>=o:o>=i;e=i>=1?++o:--o)r.push(Math.round(a[0]+n*e));return r},t.prototype.geographyBuckets=function(t){var e,n,o,a,i,r,s,l,h,u;for(null==t&&(t=5),h=this.steps(t),r=[],a=o=0,i=h.length;i>o;a=++o)l=h[a],n=0===a?0:h[a-1],u=l,e=$.grep(this.rows,function(t,e){var o;return n<=(o=t[1])&&u>=o}),r.push(function(){var t,n,o;for(o=[],t=0,n=e.length;n>t;t++)s=e[t],o.push(s[0]);return o}());return r},t}()}.call(this),function(){var t=function(t,n){function o(){this.constructor=t}for(var a in n)e.call(n,a)&&(t[a]=n[a]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t},e={}.hasOwnProperty;null==window.REW&&(window.REW={}),REW.BuildingMap=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaultOptions={icons:{building:"condo",development:"development"},sprites:{building:{url:null,x:0,y:0,width:null,height:null},development:{url:null,x:0,y:0,width:null,height:null}},states:{building:{active:"active",normal:"normal"},development:{active:"active",normal:"visited"}}},n.prototype.templates={building:HandlebarsTemplates.building_infobubble,development:HandlebarsTemplates.development_infobubble},n.prototype._iconType=function(t){return this.defaultOptions.icons[t.type]},n.prototype._iconState=function(t,e){return this.defaultOptions.states[t.type][e]},n}(REW.MarkerInfobubbles)}.call(this),function(){REW.Cache=function(){function t(t){this.size=null!=t?t:10}return t.prototype.cache=[],t.prototype.put=function(t,e){return null==this.get(t)&&this.cache.unshift([t,e]),this.cache=this.cache.slice(0,10)},t.prototype.get=function(t){var e;return e=$.grep(this.cache,function(e,n){return e[0]===t}),e.length>0?e[0][1]:null},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.CallForwarding=function(){function t(t,e){$.extend(this.options,e),this.$link=$(t),this.data={agent:this.$link.data("forwarding-agent-id"),agent_mls:this.$link.data("forwarding-agent-mls-num"),listid:this.$link.data("forwarding-property-id")||"",list_mls:this.$link.data("forwarding-property-mls-num")||"",agentphone:this.$link.data("forwarding-agent-phone"),source:this.$link.data("forwarding-source")},this._attachListeners()}return t.prototype.options={apiUrl:"",onClick:function(){}},t.prototype._attachListeners=function(){return this.$link.on("click",function(t){return function(e){return e.preventDefault(),$.getJSON(t.options.apiUrl,t.data,function(t){return window.location="tel:"+t.phone}).fail(function(){return window.location="tel:"+t.$link.attr("href")}).always(function(){return t.options.onClick()})}}(this))},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.CarouselLoader=function(){function e(e){this.loadCarousel=t(this.loadCarousel,this),this.mouseLeaveHandler=t(this.mouseLeaveHandler,this),this.mouseEnterHandler=t(this.mouseEnterHandler,this),this.$el=$(e),this.images=this.$el.data("images"),this.images.length>0&&this.attachMouseEvents()}return e.prototype.attachMouseEvents=function(){return this.$el.on("mouseenter",this.mouseEnterHandler),this.$el.on("mouseleave",this.mouseLeaveHandler)},e.prototype.mouseEnterHandler=function(){return this.loading||(this.timeoutId=setTimeout(this.loadCarousel,500)),this.$el.addClass("is-active")},e.prototype.mouseLeaveHandler=function(){return this.loading||clearTimeout(this.timeoutId),this.$el.removeClass("is-active")},e.prototype.loadCarousel=function(){var t,e,n,o,a;if(!this.loading)return this.loading=!0,t=this.$el.find(".carousel-inner"),e=t.find(".item"),n=function(){var t,n,i,r;for(i=this.images,r=[],a=t=0,n=i.length;n>t;a=++t)o=i[a],r.push(e.clone().toggleClass("active",0===a).find("img").attr("src",o).end());return r}.call(this),t.empty().append(n)},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.CharacterCounter=function(){function e(e,n,o){this.limit=o,this.charactersLeft=t(this.charactersLeft,this),this.updateLabel=t(this.updateLabel,this),this.truncate=t(this.truncate,this),this.checkLength=t(this.checkLength,this),this.$field=$(e),this.$label=$(n),this.$field.on("keyup",function(t){return function(e){return t.checkLength()||t.truncate(),t.updateLabel()}}(this)),this.$field.on("blur",function(t){return function(){return t.truncate()}}(this))}return e.prototype.checkLength=function(){return this.$field.val().length<=this.limit},e.prototype.truncate=function(){return this.$field.val(this.$field.val().substr(0,this.limit)).scrollTop(1e3)},e.prototype.updateLabel=function(){return this.$label.html(this.charactersLeft())},e.prototype.charactersLeft=function(){return this.limit-this.$field.val().length},e}(),$(function(){return $(".charactercounter[data-countcharacters]").each(function(t,e){var n,o,a;return n=$(e),o=n.find(".charactercounter-label"),a=parseInt(n.data("limit"),10),new REW.CharacterCounter(n.data("target"),o,a)})})}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.CheckboxLimiter=function(){function e(e,n){this._handleChange=t(this._handleChange,this),$.extend(this.options,n),this.$el=$(e),this.$inputs=this.$el.find("input[type=checkbox]"),this._updateVars(),this.limitReached()&&this.disableAll(),this.$inputs.on("change",this._handleChange)}return e.prototype.options={limit:5,onChange:function(){},onLimitExceeded:function(){}},e.prototype.disableAll=function(){return this.$unchecked.attr("disabled",!0).parent().addClass("disabled")},e.prototype.enableAll=function(){return this.$unchecked.removeAttr("disabled").parent().removeClass("disabled")},e.prototype.setChecked=function(){return this.$checked=this.$el.find("input:checked")},e.prototype.setUnChecked=function(){return this.$unchecked=this.$el.find("input:not(:checked)")},e.prototype._handleChange=function(){return this._updateVars(),this.limitReached()?(this.disableAll(),this.options.onLimitExceeded()):(this.enableAll(),this.options.onChange())},e.prototype._updateVars=function(){return this.setChecked(),this.setUnChecked()},e.prototype.limitReached=function(){return this.$checked.length>=this.options.limit},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.CheckboxToggle=function(){function t(t){this.$input=$(t),this.build(),this.bindEvents()}return t.prototype.build=function(){return this.$input.hide(),this.$toggle=$("<div class='checkboxtoggle-button_wrapper'><div class='checkboxtoggle-button'></div></div>"),this.$input.is(":checked")&&this.$toggle.addClass("is-active"),this.$toggle.insertAfter(this.$input)},t.prototype.bindEvents=function(){return this.$toggle.on("click",function(t){return function(e){return e.preventDefault(),t.$toggle.toggleClass("is-active"),t.$input.prop("checked",t.$toggle.hasClass("is-active")),t.$input.trigger("change")}}(this))},t.prototype.setState=function(t){return this.$input.prop("checked",t),this.$toggle.toggleClass("is-active",t)},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.ClickTracker=function(){function t(t,e){$(t).on("click",e,function(t){var e;return e=$(this).data("track-event"),REW.Tracking[e]()})}return t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.CloseModalAndClick=function(t){return this.$el=$(t),this.$el.click(function(t){var e;return t.preventDefault(),$(this).parents(".modal").modal("hide"),e=$($(this).data("target")),e.click()})},$(function(){return REW.CloseModalAndClick("[data-close-modal-and-click]")})}.call(this),function(){null==window.REW&&(window.REW={}),REW.ClusteredMap=function(){function t(t,e){this.$el=$(t),this.options=$.extend(this.options,e),this.options.mapOptions.center=new google.maps.LatLng(this.options.center.lat,this.options.center.lon),this.icons=new REW.MapLoadIcon(this.options.iconSprite),this._initMap(),this._addMarkers(),this.options.autoZoom&&this._autoZoom()}return t.prototype.options={clusterMarkerData:[],markerData:[],iconState:"normal",iconSprite:{url:null,x:0,y:0,width:null,height:null,hOffset:null,icons:[],iconStates:["normal","active","disabled"]},autoZoom:!1,center:{lat:null,lon:null},onClusterClick:function(t){},onClick:function(t){},onResize:function(t){}},t.prototype.markers=[],t.prototype.setIcon=function(t,e){var n,o,a,i,r;for(i=this.markers,r=[],n=0,o=i.length;o>n;n++)a=i[n],a.geocodeData.id===t?r.push(a.setIcon(this._clusterIcon(e))):r.push(void 0);return r},t.prototype.getMap=function(){return this.map},t.prototype._initMap=function(){var t;return google.maps.visualRefresh=!0,this.map=new google.maps.Map(this.$el.get(0),this.options.mapOptions),this.previousZoom=this.map.getZoom(),google.maps.event.addListener(this.map,"zoom_changed",function(t){return function(e){return t._isCrossingBreakPoint()&&t._addMarkers(),t.previousZoom=t.map.getZoom()}}(this)),null!=this.options.onResize?(t=new REW.MapMaximizer(this.map,{onResize:function(t){return function(e){return t.options.onResize(e)}}(this)}),this.map.controls[google.maps.ControlPosition.TOP_RIGHT].push(t.el)):void 0},t.prototype._isCrossingBreakPoint=function(){var t,e,n,o;return e=this.map.getZoom(),t=this.options.zoomBreakPoint,o=this.previousZoom>=t&&t>e,n=this.previousZoom<t&&e>=t,o||n},t.prototype._addMarkers=function(){
return this._clearMarkers(),this.map.getZoom()<this.options.zoomBreakPoint?this._addClusterMarkers():this._addIndividualMarkers()},t.prototype._clearMarkers=function(){var t,e,n,o,a;for(o=this.markers,a=[],t=0,e=o.length;e>t;t++)n=o[t],a.push(n.setMap(null));return a},t.prototype._clusterIcon=function(t){return{anchor:this._clusterIconCorner(),url:t}},t.prototype._clusterIconCorner=function(){return null!=this.clusterIconCorner?this.clusterIconCorner:this.clusterIconCorner=new google.maps.Point(this.options.clusterIconSize/2,this.options.clusterIconSize/2)},t.prototype._addClusterMarkers=function(){var t,e,n,o,a,i,r,s;for(i=this.options.clusterMarkerData,r=[],e=0,o=i.length;o>e;e++)t=i[e],n=new google.maps.LatLng(t.lat,t.lng),a=new MarkerWithLabel({position:n,map:this.map,labelContent:"<div class='mapclusterlabel-middle'><div class='mapclusterlabel-inner'>"+t.title+"</div></div>",labelAnchor:this._clusterIconCorner(),labelClass:"mapclusterlabel",icon:this._clusterIcon(this.options.clusterIconUrl),zIndex:t.count}),a.geocodeData=t,s=this,google.maps.event.addListener(a,"click",function(t){return s.options.onClusterClick(this)}),r.push(this.markers.push(a));return r},t.prototype._addIndividualMarkers=function(){var t,e,n,o,a,i,r,s,l;for(r=this.options.markerData,s=[],e=0,a=r.length;a>e;e++)t=r[e],o=new google.maps.LatLng(t.lat,t.lng),n=REW.PropertyPinSpriteMapper.map(t.property_type),i=new google.maps.Marker({position:o,map:this.map,icon:this.icons.get(n,this.options.iconState)}),i.geocodeData=t,l=this,google.maps.event.addListener(i,"click",function(t){return l.options.onClick(this.geocodeData,this)}),s.push(this.markers.push(i));return s},t.prototype._autoZoom=function(){var t,e,n,o,a;for(t=new google.maps.LatLngBounds,a=this.markers,e=0,n=a.length;n>e;e++)o=a[e],t.extend(o.getPosition());return this.map.fitBounds(t)},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.CollapseToggle=function(){function e(e){this._toggle=t(this._toggle,this),this.$el=$(e),this.$el.on("click","[data-collapse-toggle-trigger]",this._toggle)}return e.prototype._toggle=function(){return this.$el.toggleClass("is-expanded")},e}(),$(function(){return $("[data-collapse-toggle]").each(function(t,e){return new REW.CollapseToggle(e)})})}.call(this),function(){null==window.REW&&(window.REW={}),REW.ConfirmationModal=function(t,e){return this.$links=$(t),this.$modal=$(e),this.$links.on("click",function(t){return function(e){var n;return e.preventDefault(),n=$(e.target).attr("href"),t.$modal.find(".btn-primary").attr("href",n),t.$modal.modal("show")}}(this))}}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.ContactForm=function(){function e(e,n){this.selectAgent=t(this.selectAgent,this),this.$form=$(e),this.options=$.extend({},this.defaultOptions,n),new REW.AjaxFormSubmitterWithErrorHandling(e,this.options)}return e.prototype.defaultOptions={errorHolder:null,successHolder:null,onSuccess:function(){},onFailure:function(){},successEvent:"agentContact"},e.prototype.selectAgent=function(t){var e;return e=this.$form.find("#"+t).find("input:checkbox"),this.$form.find("input:checkbox").prop("checked",!1),e.prop("checked",!0)},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.DatePickerTrigger=function(){function t(t){$(t).click(function(){var t;return t=$($(this).data("datepicker-target")),t.datepicker("show")})}return t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.DeferredBuildingMap=function(){function t(t,e){this.options=$.extend({},this.defaultOptions,e),this.$el=$(t),this.loadMap()}return t.prototype.defaultOptions={icons:{building:"condo",development:"development"},sprites:{building:{url:null,x:0,y:0,width:null,height:null},development:{url:null,x:0,y:0,width:null,height:null}},labels:null,markerData:{lat:null,lng:null}},t.prototype.loadMap=function(){return new REW.GoogleMapsLoader(function(t){return function(){var e,n;return n={mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:!1,draggable:!0},e=new google.maps.Map(t.$el.get(0),n),t.buildingMap=new REW.BuildingMap(e,t.options)}}(this))},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.DeferredDevelopmentMap=function(){function t(t,e,n){this.options=$.extend({},this.defaultOptions,n),this.$el=$(t),e&&this.loadMap()}return t.prototype.deaultOptions={icons:{development:"development"},sprites:{development:{url:null,x:0,y:0,width:null,height:null}},labels:null},t.prototype.loadMap=function(){return this.isLoaded?(google.maps.event.trigger("resize",this.map),this.developmentMap.resize().fitBounds()):(this.isLoaded=!0,new REW.GoogleMapsLoader(function(t){return function(){var e,n;return n={mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:!1,draggable:!0,scrollWheel:!1},e=new google.maps.Map(t.$el.get(0),n),t.developmentMap=new REW.DevelopmentMap(e,t.options),t.developmentMap.resize().fitBounds()}}(this)))},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.DeferredPropertyMap=function(){function e(e,n,o){this._updateMapLink=t(this._updateMapLink,this),this.options=$.extend({},this.defaultOptions,o),this.$el=$(e),n&&this.loadMap()}return e.prototype.defaultOptions={iconSprite:{url:null,x:0,y:0,width:null,height:null,offset:null},labels:{beds:null,bathrooms:null,square_feet:null,link:null},map:{searchParams:{},url:null}},e.prototype.loadMap=function(){return this.isLoaded?(google.maps.event.trigger("resize",this.map),this.propertyMap.resize().fitBounds()):(this.isLoaded=!0,new REW.GoogleMapsLoader(function(t){return function(){var e,n,o;return n={mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,mapTypeControlOptions:{position:google.maps.ControlPosition.TOP_LEFT}},t.map=new google.maps.Map(t.$el.get(0),n),o=$.extend({},t.options),delete o.map,t.propertyMap=new REW.PropertyMap(t.map,o),t.options.map.url?(e={search_params:t.options.map.searchParams,url:t.options.map.url},t.$mapSearchButton=$(HandlebarsTemplates.map_search_button(e)),t.map.controls[google.maps.ControlPosition.TOP_RIGHT].push(t.$mapSearchButton.get(0)),$(t.propertyMap).on("updated",t._updateMapLink)):void 0}}(this)))},e.prototype.updateMarkers=function(t){return null!=this.propertyMap?this.propertyMap.updateMarkers(t):void 0},e.prototype._updateMapLink=function(){var t,e,n,o;return o=this.map.getZoom(),14>o&&(o=14),t=this.map.getCenter(),e=$.extend({},this.options.searchParams,{zoom:o,lat:t.lat(),lng:t.lng()}),n=this.options.map.url+"?"+$.param(e),this.$mapSearchButton.find("a").attr("href",n)},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.DelayedContent=function(){function t(t){this.$el=$(t),$.getJSON(this.$el.data("url"),function(t){return function(e,n,o){return"ready"===e.status?t.$el.replaceWith(e.data):setTimeout(function(){return new REW.DelayedContent(t.$el)},5e3)}}(this))}return t}(),$(function(){return $("[data-delayed-content]").each(function(){var t;return t=new REW.DelayedContent(this)})})}.call(this),function(){null==window.REW&&(window.REW={}),REW.DependencyAppender=function(){function t(t){$.extend(this.options,t),this.appendElements(this.options.stylesheets,this.buildCSS),this.appendElements(this.options.javascripts,this.buildJS)}return t.prototype.options={javascripts:[],stylesheets:[]},t.prototype.appendElements=function(t,e){return t.forEach(function(t){return function(t){return $("head").append(e(t))}}(this))},t.prototype.buildCSS=function(t){return"<link rel='stylesheet' type='text/css' href='"+t+"'>"},t.prototype.buildJS=function(t){return"<script type='text/javascript' src="+t+">"},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.DevelopmentLeadFormHandler=function(){function t(t,e){var n;null==e&&(e={}),$.extend(this.options,e),n=$(t),n.on("ajax:complete",function(t){return function(e,o,a){var i,r,s,l,h,u,c,p;if(u=o.responseJSON,i=n.find("input[type=submit]"),n.find("."+t.options.resultContainerClass).remove(),s=$("<div></div>",{"class":t.options.resultContainerClass}),"success"===a)return s.addClass("is-success").html(u.message),i.replaceWith(s),REW.Tracking.developmentInfoRequest();for(r=$("<ul></ul>"),p=u.errors,h=0,c=p.length;c>h;h++)l=p[h],r.append($("<li></li>",{html:l}));return s.addClass("is-error").html(u.error).append(r).insertBefore(i)}}(this))}return t.prototype.options={resultContainerClass:"developercontact-form_result"},t}()}.call(this),function(){var t=function(t,n){function o(){this.constructor=t}for(var a in n)e.call(n,a)&&(t[a]=n[a]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t},e={}.hasOwnProperty;null==window.REW&&(window.REW={}),REW.DevelopmentMap=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaultOptions={icons:{development:"development"},sprites:{development:{url:null,x:0,y:0,width:null,height:null}},defaultStates:{active:"active",normal:"visited"}},n.prototype.templates={development:HandlebarsTemplates.development_infobubble},n.prototype._iconType=function(t){return this.options.icons[t.type]},n.prototype._iconState=function(t,e){return e},n}(REW.MarkerInfobubbles)}.call(this),function(){null==window.REW&&(window.REW={}),REW.ElementAffixer=function(){function t(t,e){null==e&&(e={}),this.$el=$(t),$.extend(this.options,e),this.setOriginalPositionEl(),this.setOffset(),this.$el.affix(this.options)}return t.prototype.options={offset:{}},t.prototype.setOriginalPositionEl=function(){return this.$originalPositionEl=$("<div></div>"),this.$el.before(this.$originalPositionEl)},t.prototype.setOffset=function(){return this.options.offset.top=function(t){return function(){return t.$originalPositionEl.offset().top}}(this)},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.Expandable=function(){function t(t){this.$el=$(t),this.$collapsed=this.$el.find("[data-expandable-collapsed]"),this.collapsedHeight=this.$collapsed.height(),this.$expanded=this.$el.find("[data-expandable-expanded]"),this._attachListeners()}return t.prototype._attachListeners=function(){return this.$collapsed.find("[data-expandable-expander]").on("click",function(t){return function(e){return e.preventDefault(),t.expand()}}(this)),this.$expanded.find("[data-expandable-collapser]").on("click",function(t){return function(e){return e.preventDefault(),t.collapse()}}(this))},t.prototype.expand=function(){var t;return this.$expanded.height(this.collapsedHeight),this.$collapsed.hide(),this.$expanded.css("overflow","hidden").removeClass("hidden").show(),t=this.$expanded.get(0).scrollHeight,this.$expanded.animate({height:t},function(){return $(this).css("height","auto")})},t.prototype.collapse=function(){var t;return t=this.$expanded.get(0).scrollHeight,this.$expanded.animate({height:this.collapsedHeight},function(t){return function(){return t.$expanded.hide(),t.$collapsed.show()}}(this))},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.FieldReplace=function(){return $("[data-replace]").on("click",function(){return $(this).parents(".controls-current").hide().siblings(".controls-fields").removeClass("hidden").show()}),$("[data-cancel]").on("click",function(){return $(this).parents(".controls-fields").hide().siblings(".controls-current").removeClass("hidden").show()})},$(function(){return REW.FieldReplace()})}.call(this),function(){null==window.REW&&(window.REW={}),REW.FocusTrigger=function(){function t(t){$.extend(this.options,t),$(this.options.trigger).click(function(t){return function(e){var n;return n=$($(e.target).data("focus-target")),n.length>0||(n=$(t.options.element)),setTimeout(function(){return n.get(0).focus()},100)}}(this))}return t.prototype.options={element:"[data-focus-target]",trigger:"[data-focus-trigger]"},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.FormErrors=function(){function t(t,e){this.$form=$(t),this.clear(),this.render(e)}return t.prototype.render=function(t){var e,n,o,a,i,r,s;s=[];for(i in t)r=t[i],n=this.$form.find("[name*='"+i+"']"),e=n.parents(".controls"),e.addClass("error"),e.parent(".form-group").addClass("error"),s.push(function(){var t,n,i;for(i=[],t=0,n=r.length;n>t;t++)o=r[t],a=$("<span class='help-block'>"+o+"</span>"),i.push(e.append(a));return i}());return s},t.prototype.clear=function(){return this.$form.find(".controls.error .help-block").remove(),this.$form.find(".error").removeClass("error")},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.GalleriaWrapper=function(){function t(t,e){Galleria.run(t,e),this.gallery=$(t).data("galleria"),Galleria.ready(function(){var t,e;return e=this,e.addElement("exit").appendChild("container","exit"),t=e.$("exit").hide().html("&times;").click(function(){return e.exitFullscreen()}),e.bind("fullscreen_enter",function(){return t.show()}),e.bind("fullscreen_exit",function(){return t.hide()})})}return t.prototype.openLightbox=function(){return Galleria.TOUCH?this.gallery.enterFullscreen():this.gallery.openLightbox()},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.ScriptLoader={load:function(t,e){return yepnope.injectJs(t,e)}}}.call(this),function(){null==window.REW&&(window.REW={}),REW.GoogleMapsLoader=function(){function t(t,e,n){var o;null==e&&(e=[]),null==n&&(n="AIzaSyCGNHupVDIt5_IKJ2kx2CYYgsEtni7aLBY"),REW.initializeMap=function(){return google.maps.visualRefresh=!0,t()},null!=("undefined"!=typeof google&&null!==google?google.maps:void 0)?t():(o="https://maps.googleapis.com/maps/api/js?v=3.25&libraries="+e+"&callback=REW.initializeMap&key="+n,REW.ScriptLoader.load(o))}return t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.GroupedAutocomplete=function(){function e(e,n){this._checkQueryChange=t(this._checkQueryChange,this),this._renderItem=t(this._renderItem,this),this._renderMenu=t(this._renderMenu,this),this._initAutocomplete=t(this._initAutocomplete,this),this.$el=$(e),this.$form=this.$el.parents("form"),this.options=$.extend({},this.defaultOptions,n),this._initAutocomplete(),this._attachEvents()}return e.prototype.defaultOptions={categoryClass:"autocomplete-category",labels:{address:null,agent:null,building:null,newItem:null,place:null},resultsClasses:{newRecord:"autocomplete-results_subtitle_blue",title:"autocomplete-results",subtitle:"autocomplete-results_subtitle"},source:null,submitWithoutId:!0},e.prototype._initAutocomplete=function(){var t;return this.$autocomplete=$(this.$el).autocomplete({source:this.options.source,select:function(t){return function(e,n){var o;return o=n.item,t.$form.find("#autocomplete_type").val(o.hint),t.$form.find("#autocomplete_id").val(o.hint_id),t.$form.find("#autocomplete_value").val(o.value),t.$el.val(o.value),null!=o.hint_id||t.options.submitWithoutId?t.$form.submit():void 0}}(this)}).autocomplete("instance"),this.$autocomplete.widget().menu("option","items","> :not(."+this.options.categoryClass+")"),this.$autocomplete._renderMenu=this._renderMenu,("undefined"!=typeof navigator&&null!==navigator&&null!=(t=navigator.userAgent)?t.match(/iP(hone|od|ad)/):void 0)?this.$autocomplete.widget().off("mouseenter"):void 0},e.prototype._renderMenu=function(t,e){var n;return n="",$.each(e,function(e){return function(o,a){return a.type!==n&&(t.append($(HandlebarsTemplates.autocomplete_category({categoryClass:e.options.categoryClass,itemType:a.type,label:e.options.labels[a.type]}))),n=a.type),e.$autocomplete._renderItem=e._renderItem(t,a)}}(this))},e.prototype._renderItem=function(t,e){var n;return n=$(HandlebarsTemplates.autocomplete_item({item:e,resultsClasses:this.options.resultsClasses,newItem:this.options.labels.newItem})),n.data("ui-autocomplete-item",e).appendTo(t)},e.prototype._attachEvents=function(){return this.$form.on("ajax:before, submit",this._checkQueryChange)},e.prototype._checkQueryChange=function(){var t,e;return t=this.$el.val(),e=this.$form.find("#autocomplete_value").val(),t!==e?this.$form.find("#autocomplete_type, #autocomplete_id").val(null):void 0},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.HorizontalBarGraph=function(){function t(t,e){this.options=e,this.$el=$(t),this.$anchor=$(this.options.anchor),this.$triggers=$(this.options.triggers),this.barSelector=this.options.barSelector,this.dataAttribute=this.options.dataAttribute,this.animationDuration=500,this.initGraph()}return t.prototype.options={anchor:null,activeTab:null,triggers:null,barSelector:null,dataAttribute:null},t.prototype.currentValues=null,t.prototype.previousValues=null,t.prototype.resetBars=function(t){return t.find(this.barSelector).each(function(){return $(this).css("width",0)})},t.prototype.animateBars=function(t){return t.animate({opacity:1},this.animationDuration,function(e){return function(n){var o;return o=t.data(e.dataAttribute),t.find(e.barSelector).each(function(t,e){var n;return n=o[$(e).parent().index()],$(e).animate({width:100*n+"%"},this.animationDuration)})}}(this))},t.prototype.initGraph=function(){return this.$anchor.waypoint({handler:function(t){return function(){var e,n;return e=$(t.options.activeTab),n=$(e.attr("href")),t.resetBars(n),t.animateBars(n)}}(this),offset:"bottom-in-view",triggerOnce:!0}),this.$triggers.on("show",function(t){return function(e){var n,o;return e.target,e.relatedTarget,n=$($(e.relatedTarget).attr("href")),n.animate({opacity:0},t.animationDuration),o=$($(e.target).attr("href")),o.css("opacity",0),t.resetBars(o)}}(this)),this.$triggers.on("shown",function(t){return function(e){var n;return e.target,n=$($(e.target).attr("href")),t.animateBars(n)}}(this))},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.ImageUploader=function(){function t(t,e){this.$el=$(t),$.extend(this.options,e),this.$el.on("removeAttachment",function(t){return function(e){var n,o;return n=t.$el.find("img"),o=n.data("placeholder"),n.attr("src",o)}}(this)),this.$el.on("imageChanged",function(t){return function(e,n){var o;return o=$.cloudinary.url(n.public_id,t.$el.data("transform")),t.$el.find("img").attr("src",o)}}(this))}return t.prototype.options={},t}(),$(function(){return $("[data-imageuploader]").each(function(){return new REW.ImageUploader(this)})})}.call(this),function(){null==window.REW&&(window.REW={}),REW.InputSuggestions=function(){function t(t,e){this.$input=$(t),this.$suggestions=$(e),this.$input.on("focus change keyup",function(t){return function(e){var n;return n=e.target.value.length,t.$suggestions.toggle(1>=n&&0===$(".ui-autocomplete:visible").length),t.$suggestions.removeClass("hidden")}}(this)).on("blur",function(t){return function(){return t.$suggestions.addClass("hidden")}}(this))}return t}()}.call(this),function(){$("[data-ij4ClvR5wq]").remove(),$(function(){var t;return t=HandlebarsTemplates.inverse_captcha({name:"ij4ClvR5wq_human"}),$("[data-ij4ClvR5wq-js]").append(t)})}.call(this),function(){null==window.REW&&(window.REW={}),REW.ListingLinkUpdater=function(){function t(t){$("[data-listing-link] a").each(function(e,n){var o;return o=this.href.replace(/\?.*/,""),""!==$.param(t)?this.href=o+"?"+$.param(t):void 0})}return t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.ListingWidgetRetriever=function(){function t(t){$.ajax({url:t}).done(function(t){return new REW.DependencyAppender(t)})}return t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.LoginHandler=function(){function t(){}return t.loginAndProcess=function(t,e){var n;return null==e&&(e="#sign_up"),n=$("#loginForm"),REW.logged_in?t():($("#login form").data("submitter").options.onSuccess=function(e){return function(e,o,a){return REW.logged_in=e.resource,$("meta[name='csrf-token']").attr("content",e.csrf_token),$("[name='"+e.csrf_param+"']").val(e.csrf_token),t(e.redirect),REW.BannerNavLoader.load(),n.modal("hide")}}(this),$("#sign_up form").data("submitter").options.onSuccess=function(e){return function(e){return REW.logged_in=e,REW.Tracking.userSignup(),t(),REW.BannerNavLoader.load(),n.modal("hide")}}(this),REW.ModalTabSelector(n,"[data-toggle=tab][href="+e+"]"))},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.MapLayers=function(){function e(e,n,o,a){this.map=e,this.property=o,this.createFusionLayer=t(this.createFusionLayer,this),this.getFusionLayer=t(this.getFusionLayer,this),this.addFusionLayer=t(this.addFusionLayer,this),this.addMarkers=t(this.addMarkers,this),this.addYelpLayer=t(this.addYelpLayer,this),this.createKmlLayer=t(this.createKmlLayer,this),this.getKmlLayer=t(this.getKmlLayer,this),this.addKmlLayer=t(this.addKmlLayer,this),$.extend(this.options,a),this.yelp=new REW.Yelp(this.options.yelpUrl),this.icons=new REW.MapLoadIcon(this.options.iconSprite),this.$mapContainer=$(n),this.addPropertyMarker(),this.addPullTab(),this.$layerTriggers=$(".pulltab-content input:checkbox"),this.addLayers(),this.setLayerTriggerActions()}return e.prototype.options={isOpen:!0,expand:{amenities:!1,layers:!1},direction:"up",elementarySchools:"Elementary Schools",secondarySchools:"Secondary Schools",schools:"Schools",transit:"Transit",restaurants:"Restaruants",neighborhood:"Neighbourhood",banks:"Banks",coffee:"Coffee shops",taxAssessment:"Tax Assessment",iconSprite:{url:null,x:0,y:0,width:null,height:null,hOffset:null,vOffset:null,icons:[],iconStates:["normal","active","disabled"]},iconState:"normal",zoom:13,yelpUrl:""},e.prototype.drawPolygon=function(t){var e,n,o,a,i,r,s,l,h,u;if(t){for(u=t.split(" "),l=[],a=0,r=u.length;r>a;a++)n=u[a],o=n.split(","),s=parseFloat(o[0],10),i=parseFloat(o[1],10),l.push(new google.maps.LatLng(i,s));return h=new google.maps.Polygon({paths:l,strokeColor:"#FF7C14",strokeWeight:2,fillColor:"#FF5904",fillOpacity:.5}),h.setMap(this._getMap()),e=this._pathCenter(l),this.marker.setPosition(e)}},e.prototype._pathCenter=function(t){var e,n,o,a,i;return e=function(){var e,n,o;for(o=[],e=0,n=t.length;n>e;e++)i=t[e],o.push(i.lat());return o}(),e=this._discardNaN(e),n=function(){var e,n,o;for(o=[],e=0,n=t.length;n>e;e++)i=t[e],o.push(i.lng());return o}(),n=this._discardNaN(n),o=this._mid(e),a=this._mid(n),new google.maps.LatLng(o,a)},e.prototype._mid=function(t){var e,n;return n=this._min(t),e=this._max(t),n+(e-n)/2},e.prototype._max=function(t){return Math.max.apply(null,t)},e.prototype._min=function(t){return Math.min.apply(null,t)},e.prototype._discardNaN=function(t){return $.grep(t,function(t,e){return $.isNumeric(t)})},e.prototype.addPropertyMarker=function(){var t,e;return e=REW.PropertyPinSpriteMapper.map(this.property.property_type),t=this.options.iconState,this.property.has_open_house&&(t+="_open"),this.marker=new google.maps.Marker({position:new google.maps.LatLng(this.property.lat,this.property.lng),map:this._getMap(),icon:this.icons.get(e,t),title:this.property.title}),this._getMap().setCenter(this.marker.getPosition()),this._getMap().setZoom(this.options.zoom)},e.prototype._getMap=function(){return this.map},e.prototype.addLayers=function(){return this.$layerTriggers.filter("[data-type=kml]").each(this.addKmlLayer),this.$layerTriggers.filter("[data-type=yelp]").each(this.addYelpLayer),this.$layerTriggers.filter("[data-type=fusion]").each(this.addFusionLayer)},e.prototype.addKmlLayer=function(t,e){return $(e).on("change",function(t){return function(e){var n,o,a;return n=$(e.target),a=t.getKmlLayer(n),o=n.prop("checked"),a.setMap(o?t._getMap():null)}}(this))},e.prototype.getKmlLayer=function(t){var e,n;return e=$(t),n=e.data("layer"),n||(n||(n=this.createKmlLayer(e)),e.data("layer",n)),n},e.prototype.createKmlLayer=function(t){var e,n,o,a;return e=$(t),n=e.data("category"),o={url:e.data("url"),options:{clickable:!0,preserveViewport:!0,suppressInfoWindows:!0}},a=new google.maps.KmlLayer(o.url,o),google.maps.event.addListener(a,"click",function(t){return function(e){var o;return t.infoWindow&&t.infoWindow.close(),o=HandlebarsTemplates.school_infobubble($.extend({},e.featureData,{category:n})),t.infoWindow=new InfoBubble({content:o,minWidth:150,minHeight:50,maxHeight:100,maxWidth:150,paddding:10,borderRadius:0,arrowStyle:0,arrowPosition:50,arrowSize:15,shadowStyle:0,disableAutoPan:!1}),t.infoWindow.setPosition(e.latLng),t.infoWindow.open(t._getMap())}}(this)),a},e.prototype.addYelpLayer=function(t,e){var n;return n=$(e),n.on("change",function(t){return function(e){var n,o,a,i,r;return n=$(e.target),r=n.is(":checked"),r&&!n.data("yelp_loaded")&&(n.data("yelp_loaded",!0),a=n.data("term"),o=n.data("icon"),i=t._getMap().getCenter(),t.yelp.search(a,i.lat(),i.lng(),function(e){var a;return a=t.addMarkers(e,o),n.data("markers",a),t.toggleMarkers(n.data("markers"),n.is(":checked"))})),t.toggleMarkers(n.data("markers"),r)}}(this))},e.prototype.toggleMarkers=function(t,e){var n,o,a,i;for(null==t&&(t=[]),i=[],n=0,o=t.length;o>n;n++)a=t[n],i.push(a.setVisible(e));return i},e.prototype.addMarkers=function(t,e){var n,o;return o=function(){var o,a,i;for(i=[],o=0,a=t.length;a>o;o++)n=t[o],i.push(this.addMarker(n,e));return i}.call(this)},e.prototype.addMarker=function(t,e){var n;return n=new google.maps.Marker({position:new google.maps.LatLng(t.latitude,t.longitude),icon:this.icons.get(e),flat:!0,map:this._getMap(),title:t.name}),n.iconType=e,google.maps.event.addListener(n,"click",function(e){return function(){var o;return e.infoWindow&&(e.infoWindow.close(),e.infoWindow.marker.setIcon(e.icons.get(n.iconType))),o=HandlebarsTemplates.yelp_infobubble(t),e.infoWindow=new InfoBubble({content:o,minWidth:285,minHeight:126,maxHeight:126,maxWidth:285,paddding:10,borderRadius:0,arrowStyle:0,arrowPosition:50,arrowSize:15,shadowStyle:0,disableAutoPan:!1}),e.infoWindow.marker=n,e.infoWindow.addListener("closeclick",function(){return e.infoWindow.marker.setIcon(e.icons.get(n.iconType))}),n.setIcon(e.icons.get(n.iconType,"active")),e.infoWindow.open(e._getMap(),n)}}(this)),n},e.prototype.addPullTab=function(){var t,e;return e=$.extend({},this.options,{narrow:"right"===this.options.direction}),t=$(HandlebarsTemplates.mapcontrols(e)),this.$mapContainer.after(t),this.pullTab=new REW.Pulltab(t),t.find("#amenities").on("shown",function(){return $("#amenitiesCollapseIcon").removeClass("is-collapsed")}).on("hidden",function(){return $("#amenitiesCollapseIcon").addClass("is-collapsed")}),t.find("#layers").on("shown",function(){}).on("hidden",function(){return $("#layersCollapseIcon").addClass("is-collapsed")}),t.on("pulltab.collapsed",function(t){return function(){return t.$mapContainer.removeClass("has-controls")}}(this)).on("pulltab.expanded",function(t){return function(){return t.$mapContainer.addClass("has-controls")}}(this))},e.prototype.addFusionLayer=function(t,e){return $(e).on("change",function(t){return function(e){var n,o,a;return n=$(e.target),a=t.getFusionLayer(n),o=n.prop("checked"),a.setMap(o?t._getMap():null)}}(this))},e.prototype.getFusionLayer=function(t){var e,n;return e=$(t),n=e.data("layer"),n||(n=this.createFusionLayer(e),e.data("layer",n)),n},e.prototype.setLayerTriggerActions=function(){return this.$layerTriggers.each(function(t){return function(e,n){return $(n).click(function(){var e;return null!=(e=t.infoWindow)?e.close():void 0})}}(this))},e.prototype.createFusionLayer=function(t){var e,n,o;return e=$(t),o=e.data("table"),n=new google.maps.FusionTablesLayer({supressInfoWindows:!0,query:{from:o},styles:[{polygonOptions:{fillColor:"#f6b26b",fillOpacity:.3,strokeColor:"#f6b26b"}}],options:{suppressInfoWindows:!0}}),google.maps.event.addListener(n,"click",function(t){return function(e){var n;return n={value:{land:e.row.current_land_value.value,improvement:e.row.current_improvement_value.value,total:e.row.current_total_value.value,legalType:e.row.legal_type.value,isStrata:"STRATA"===e.row.legal_type.value},address:{number:e.row.civic_number.value,street:e.row.std_street.value}},t.infoWindow&&t.infoWindow.close(),t.infoWindow=new InfoBubble({content:HandlebarsTemplates.assessment(n),minWidth:150,minHeight:80,maxWidth:150,paddding:10,borderRadius:0,arrowStyle:0,arrowPosition:50,arrowSize:15,shadowStyle:0,disableAutoPan:!0}),t.infoWindow.setPosition(e.latLng),t.infoWindow.open(t._getMap())}}(this)),n},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.MapLayersAreaMap=function(){function e(e,n,o,a){var i,r;this.property=n,this.polygonCoords=o,this.createAssessmentLayer=t(this.createAssessmentLayer,this),this.addMarkers=t(this.addMarkers,this),this._showAssessments=t(this._showAssessments,this),this._showTable=t(this._showTable,this),this._showBusinesses=t(this._showBusinesses,this),this._showSchools=t(this._showSchools,this),this.addLayer=t(this.addLayer,this),this._drawPolygon=t(this._drawPolygon,this),$.extend(this.options,a),this.yelp=new REW.Yelp(this.options.yelpUrl),this.icons=new REW.MapLoadIcon(this.options.iconSprite),this.cacheYelp={},this.$mapContainer=$(e),this.map=this.initializeMap(),this.$infoTable=this.options.infoTable,this.addPropertyMarker(),this.addControls(),this.$layerTriggers=$(".dropdown--areamap-select_menu input:radio"),this.addLayers(),this.setLayerTriggerActions(),new REW.MapViewControls(this.options.viewControls,this.map),r=[],i=null}return e.prototype.options={isOpen:!0,showAssessments:!1,schools:"Schools",neighbourhood:"Neighbourhood",restaurants:"Restaurants",banks:"Banks",coffee:"Coffee Shops",taxAssessment:"Tax Assessment",labels:{school:"School",grades:"Grades",category:"Category",distance:"Distance",rating:"Star Rating"},icon:"development",iconSprite:{url:null,x:0,y:0,width:null,height:null,hOffset:null,vOffset:null,icons:[],iconStates:["normal","active","visited"]},zoom:13,yelpUrl:"",infoTable:"",viewControls:null},e.prototype.initializeMap=function(){var t,e;return e=REW.SnazzyStyles.BlueWater,t={mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,panControl:!1,styles:e},new google.maps.Map(this.$mapContainer.get(0),t)},e.prototype.resize=function(){return google.maps.event.trigger(this._getMap(),"resize"),this._getMap().setCenter(this.marker.getPosition())},e.prototype.addPropertyMarker=function(){return this.marker=new google.maps.Marker({position:new google.maps.LatLng(this.property.lat,this.property.lng),map:this._getMap(),icon:this.icons.get(this.options.icon,"visited"),title:this.property.title}),this._getMap().setCenter(this.marker.getPosition()),this._getMap().setZoom(this.options.zoom),this._drawPolygon()},e.prototype._getMap=function(){return this.map},e.prototype._drawPolygon=function(){var t;return this.polygonCoords?(t=REW.MapPolygon(this.polygonCoords),this.activeLayer=t,t.setMap(this._getMap())):void 0},e.prototype.addLayers=function(){return this.addLayer(this.$layerTriggers.filter("[data-type=yelp]"),this._showBusinesses),this.addLayer(this.$layerTriggers.filter("[data-type=fusion]"),this._showAssessments),this.addLayer(this.$layerTriggers.filter("[data-type=polygon]"),this._drawPolygon),this.addLayer(this.$layerTriggers.filter("[data-type=data]"),this._showSchools)},e.prototype.addLayer=function(t,e){return t.on("click",function(t){return function(n){var o;return o=$(n.target),t.removeData(),t._getMap().setCenter(t.marker.getPosition()),$('[data-type="map-menu"] span').html(o.siblings("label").text()),"fusion"===o.data("type")?t._getMap().setZoom(17):t._getMap().setZoom(t.options.zoom),e(o)}}(this))},e.prototype._showSchools=function(t){var e,n,o,a;return e=t.data("icon"),o=this.options.schoolArray,a=t.data("source"),n=this.addMarkers(o,e,a),t.data("markers",n),this.populateTable(o,a,null),this.activeMarkers=n,this.toggleMarkers(t.data("markers"),!0)},e.prototype._showBusinesses=function(t){var e;return e=t.data("term"),null!=this.cacheYelp[e]?this._showTable(t,e):this.yelp.search(e,this.property.lat,this.property.lng,function(n){return function(o){return n.cacheYelp[e]=o,n._showTable(t,e)}}(this))},e.prototype._showTable=function(t,e){var n,o,a,i;return n=this.cacheYelp[e],o=t.data("icon"),i=t.data("type"),a=this.addMarkers(n,o,"yelp"),t.data("markers",a),this.activeMarkers=a,this.toggleMarkers(t.data("markers"),!0),this.populateTable(n,i,e)},e.prototype._showAssessments=function(t){var e,n;return e=$(t),n=e.data("layer"),n||(n=this.createAssessmentLayer(e),e.data("layer",n)),this.activeLayer=n,n.setMap(this._getMap())},e.prototype.removeData=function(){var t;return this.$infoTable.empty(),this.toggleMarkers(this.activeMarkers,!1),null!=(t=this.activeLayer)&&t.setMap(null),this.activeMarkers=[]},e.prototype.toggleMarkers=function(t,e){var n,o,a,i;for(null==t&&(t=[]),i=[],n=0,o=t.length;o>n;n++)a=t[n],i.push(a.setVisible(e));return i},e.prototype.addMarkers=function(t,e,n){var o,a,i,r;for(r=[],o=0,a=t.length;a>o;o++)i=t[o],
r.push(this.addMarker(i,e,n));return r},e.prototype.populateTable=function(t,e,n){var o,a,i,r;return r=$.extend({},this.options.labels,{business:n}),i=e+"_table",a=$(HandlebarsTemplates[i]({data:t.slice(0,10),labels:r})),this.$infoTable.append(a),o=this.$infoTable.children("tbody").children("tr"),o.each(function(t){return function(e,n){return $(n).on("click",function(e){return google.maps.event.trigger(t.activeMarkers[$(n).attr("id")],"click")})}}(this))},e.prototype.addMarker=function(t,e,n){var o;return o=new google.maps.Marker({id:t.id,position:new google.maps.LatLng(t.latitude,t.longitude),icon:this.icons.get(e),flat:!0,map:this._getMap(),title:t.name}),o.iconType=e,google.maps.event.addListener(o,"click",function(e){return function(){var a,i;switch(e.infoWindow&&(e.infoWindow.close(),e.infoWindow.marker.setIcon(e.icons.get(o.iconType))),n){case"yelp":a=HandlebarsTemplates.yelp_infobubble(t),i=126;break;case"schools":a=HandlebarsTemplates.school_infobubble(t),i=110;break;default:throw new Error("Invalid source: "+n)}return e.infoWindow=new InfoBubble({content:a,minWidth:285,minHeight:i,maxHeight:i,maxWidth:285,paddding:10,borderRadius:0,arrowStyle:0,arrowPosition:50,arrowSize:15,shadowStyle:0,disableAutoPan:!1}),e.infoWindow.marker=o,e.infoWindow.addListener("closeclick",function(){return e.infoWindow.marker.setIcon(e.icons.get(o.iconType))}),o.setIcon(e.icons.get(o.iconType,"active")),e.infoWindow.open(e._getMap(),o)}}(this)),o},e.prototype.addControls=function(){var t;return t=$(HandlebarsTemplates.areamapcontrols_dropdown(this.options)),this.$mapContainer.after(t)},e.prototype.setLayerTriggerActions=function(){return this.$layerTriggers.each(function(t){return function(e,n){return $(n).click(function(){var e;return null!=(e=t.infoWindow)?e.close():void 0})}}(this))},e.prototype.createAssessmentLayer=function(t){var e,n,o;return e=$(t),o=e.data("table"),n=new google.maps.FusionTablesLayer({supressInfoWindows:!0,query:{from:o},styles:[{polygonOptions:{fillColor:"#f6b26b",fillOpacity:.3,strokeColor:"#f6b26b"}}],options:{suppressInfoWindows:!0}}),google.maps.event.addListener(n,"click",function(t){return function(e){var n,o;return n={value:{land:e.row.current_land_value.value,improvement:e.row.current_improvement_value.value,total:e.row.current_total_value.value,legalType:e.row.legal_type.value,isStrata:"STRATA"===e.row.legal_type.value},address:{number:e.row.civic_number.value,street:e.row.std_street.value}},null!=(o=t.infoWindow)&&o.close(),t.infoWindow=new InfoBubble({content:HandlebarsTemplates.assessment(n),minWidth:150,minHeight:80,maxWidth:150,paddding:10,borderRadius:0,arrowStyle:0,arrowPosition:50,arrowSize:15,shadowStyle:0,disableAutoPan:!0}),t.infoWindow.setPosition(e.latLng),t.infoWindow.open(t._getMap())}}(this)),n},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.MapLoadIcon=function(){function e(e){this.sprite=e,this.get=t(this.get,this)}return e.prototype.get=function(t,e){var n,o,a;return null==e&&(e="normal"),o=this.sprite.x+this.sprite.iconStates.indexOf(e)*this.sprite.hOffset,a=this.sprite.y+this.sprite.icons.indexOf(t)*this.sprite.vOffset,n={url:this.sprite.url,size:new google.maps.Size(this.sprite.width,this.sprite.height),origin:new google.maps.Point(o,a)},null!==this.sprite.scaledWidth&&(n.scaledSize=new google.maps.Size(this.sprite.scaledWidth,this.sprite.scaledHeight)),n},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.MapMaximizer=function(){function t(t,e){this.map=t,this.options=$.extend(this.options,e),this.$el=$(HandlebarsTemplates.map_maximizer()),this.el=this.$el.get(0),this._attachEvents()}return t.prototype.options={onResize:function(t){}},t.prototype._attachEvents=function(){return google.maps.event.addDomListener(this.el,"click",function(t){return function(e){var n;return n=t.map.getCenter(),t.$el.toggleClass("is-maximized"),t.$el.parents(".map").toggleClass("map--fullscreen"),google.maps.event.trigger(t.map,"resize"),t.map.setCenter(n),t.options.onResize(t.$el.hasClass("is-maximized"))}}(this))},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.MapPolygon=function(t){var e,n,o,a,i;return this.coordinates=t,a=function(){var t,a,i,r;for(i=this.coordinates,r=[],t=0,a=i.length;a>t;t++)e=i[t],n=e[0],o=e[1],r.push(new google.maps.LatLng(n,o));return r}.call(this),i=new google.maps.Polygon({paths:a,strokeColor:"#808C91",strokeWeight:2,fillColor:"#808C91",fillOpacity:.5})}}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};null==window.REW&&(window.REW={}),REW.MapSearch=function(){function n(e,n){this._updatePolygon=t(this._updatePolygon,this),this._highlightCurrentPolygon=t(this._highlightCurrentPolygon,this),this._zoomGeography=t(this._zoomGeography,this),this._dispatchChange=t(this._dispatchChange,this),this._showListingInfoBubble=t(this._showListingInfoBubble,this),this._dispatchZoomChanged=t(this._dispatchZoomChanged,this),this._handleZoom=t(this._handleZoom,this),this._getRewBounds=t(this._getRewBounds,this),this._initMap=t(this._initMap,this),this.closeInfoWindow=t(this.closeInfoWindow,this),this.mappedPropertyTypes=t(this.mappedPropertyTypes,this),this.$el=$(e),$.extend(this.options,n),google.maps.event.addDomListener(window,"load",this._initMap),this.listingMarkers=[],this.$currentCity=$(this.options.currentCitySelector),this.$currentNeighborhood=$(this.options.currentNeighborhoodSelector),this.icons=new REW.MapLoadIcon(this.options.iconSprite),this.developmentPin=new REW.MapLoadIcon(this.options.developmentIconSprite),this.propertyTypeMappings={apartment_condo:["apartment_condo"],duplex:["duplex","half_duplex"],house:["house","chalet"],land_lot:["land_lot"],other:["other","timeshare","recreational","mfd_mobile_home","shared_owner"],townhouse:["townhouse","multifamily"],triplex:["triplex"],fourplex:["fourplex"]}}return n.prototype.options={defaultCenter:{lat:49.2844,lng:-123.0809},developments:[],developmentIconSprite:{url:null,x:0,y:0,width:null,height:null,scaledWidth:null,scaledHeight:null,hOffset:null,vOffset:null,icons:[],iconStates:["normal","active","visited"]},geographiesUrl:null,geographyTable:{id:null,style_id:null,template_id:null},iconSprite:{url:null,x:0,y:0,width:null,height:null,scaledWidth:null,scaledHeight:null,hOffset:null,vOffset:null,icons:[],iconStates:["normal","active","visited","normal_open","active_open","visited_open"]},key:null,locationSelector:null,tabMenu:null,propertyTypesSelector:null,rewBounds:null,zoom:{minZoom:10,city:12,"default":13,showLabel:14,neighborhood:15}},n.prototype.mappedPropertyTypes=function(t){return this.propertyTypeMappings[t]},n.prototype.values=function(){var t,e;return t=this.map.getBounds(),e={lat:this.getCenter().lat(),lng:this.getCenter().lng(),zoom:this.map.getZoom()},t&&(e.bounds={sw:t.getSouthWest().toString().replace(/[ \(\)]/g,""),ne:t.getNorthEast().toString().replace(/[ \(\)]/g,"")}),e},n.prototype.setValues=function(t){var e,n;return this._detachEvents(),null!=t.lat&&null!=t.lng?this._centerMap(t.lat,t.lng,t.zoom):null!=(null!=(e=t.bounds)?e.sw:void 0)&&null!=(null!=(n=t.bounds)?n.ne:void 0)?this._fitBounds(t.bounds):this._centerMap(),this.unhighlightListing(),this._handleZoom(),this._attachEvents()},n.prototype.showCities=function(){return this._setGeographyLayer("type = 'city'"),this.showGeographies()},n.prototype.showNeighborhoods=function(){return this._setGeographyLayer("type = 'neighbourhood'"),this.showGeographies()},n.prototype.hideGeographies=function(){return this.geographyLayer.setMap(null)},n.prototype.showGeographies=function(){return this.geographyLayer.setMap(this.map)},n.prototype.hideListings=function(){return this.closeInfoWindow(),this._clearListingMarkers()},n.prototype.showListings=function(){},n.prototype.closeInfoWindow=function(){return null!=this.infoBubble?this.infoBubble.close():void 0},n.prototype._initMap=function(){return this.map=this._createMap(),this._addControls(),this._addDevelopmentMarkers(),this._addGeographyLayer(),this._initAutocomplete(),google.maps.event.addListener(this.map,"dragend",function(t){return function(){return clearTimeout(t.polygonTimeout),t.polygonTimeout=setTimeout(t._highlightCurrentPolygon,500)}}(this)),google.maps.event.addListener(this.map,"click",function(t){return function(){return t.closeInfoWindow(),t.unhighlightListing()}}(this)),this._attachEvents(),google.maps.event.addListenerOnce(this.map,"bounds_changed",function(t){return function(){return $(t).trigger("mapready")}}(this))},n.prototype._createMap=function(){var t,e;return e={center:new google.maps.LatLng(this.options.defaultCenter.lat,this.options.defaultCenter.lng),zoom:this.options.zoom["default"],mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:!1,zoomControl:!1,minZoom:this.options.zoom.minZoom},t=new google.maps.Map(this.$el.get(0),e)},n.prototype._fitBounds=function(t){var e,n,o,a,i,r;return o=t.sw.split(","),i=o[0],r=o[1],a=t.ne.split(","),n=a[0],e=a[1],this.map.fitBounds({north:parseFloat(n,10),south:parseFloat(i,10),east:parseFloat(e,10),west:parseFloat(r,10)})},n.prototype._centerMap=function(t,e,n){return null==t&&(t=this.options.defaultCenter.lat),null==e&&(e=this.options.defaultCenter.lng),null==n&&(n=this.options.zoom),this.map.setZoom(n),this.map.setCenter(new google.maps.LatLng(t,e))},n.prototype._initAutocomplete=function(){var t,n;return t=$(this.options.locationSelector),n={componentRestrictions:{country:"ca"}},this.autocomplete=new google.maps.places.Autocomplete(t.get(0),n),google.maps.event.addListener(this.autocomplete,"place_changed",function(n){return function(){var o,a,i,r,s;return r=n.autocomplete.getPlace(),r.geometry?(n.map.panTo(r.geometry.location),s=r.types,a=e.call(s,"locality")>=0,o=null==r.geometry.viewport,i=e.call(s,"neighborhood")>=0||e.call(s,"sublocality")>=0,a?n.map.setZoom(n.options.zoom.city):i||o?n.map.setZoom(n.options.zoom.neighborhood):n.map.fitBounds(r.geometry.viewport),google.maps.event.trigger(n.map,"dragend"),null!=n.placeMarker&&n.placeMarker.setMap(null),n.placeMarker=new google.maps.Marker({map:n.map,position:r.geometry.location}),n._getRewBounds().contains(r.geometry.location)||new REW.OutOfBoundsModal({key:"_REW_interactive_maps_helpscreen_visibility_toggle"}),t.val(""),n.options.tabMenu.closeTabs()):void 0}}(this))},n.prototype._getRewBounds=function(){var t,e;return e=new google.maps.LatLng(this.options.rewBounds[0][0],this.options.rewBounds[0][1]),t=new google.maps.LatLng(this.options.rewBounds[1][0],this.options.rewBounds[1][1]),new google.maps.LatLngBounds(e,t)},n.prototype._handleZoom=function(){if(this.zoom!==this.map.getZoom()){switch(this.zoom=this.map.getZoom(),!1){case!(this.zoom<=this.options.zoom.city):this.showCities();break;case!(this.zoom>=this.options.zoom.neighborhood):this.hideGeographies();break;default:this.showNeighborhoods()}return this.showListings(),this.showDevelopments(),this._highlightCurrentPolygon(),clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout(this._dispatchZoomChanged,200)}},n.prototype._dispatchZoomChanged=function(){return $(this).trigger("zoom_changed",{zoom:this.map.getZoom(),listingsVisible:this.listingsVisible})},n.prototype._showListingInfoBubble=function(t,e){var n,o;return this.closeInfoWindow(),this.infoBubble=new InfoBubble({backgroundColor:"#ffffff",borderRadius:0,hideCloseButton:!0,padding:0,shadowStyle:1,position:e,maxWidth:188,minHeight:210,maxHeight:230}),o=t.listing,o.url=t.trackable_url,n=$(HandlebarsTemplates.listing_infobubble($.extend({"class":"infobubble--listingmap"},o))),n.on("click",function(t){return t.preventDefault(),window.location=o.url}),this.infoBubble.setContent(n.get(0)),this.infoBubble.open(this.map)},n.prototype._setCurrentCity=function(t){return this.$currentCity.html(t)},n.prototype._setCurrentNeighborhood=function(t){return this.$currentNeighborhood.html(t)},n.prototype._initGeographyEvents=function(){return google.maps.event.addListener(this.geographyLayer,"click",function(t){return function(e){return t.closeInfoWindow()}}(this))},n.prototype._isGeographiesVisible=function(){return null!=this.geographyLayer&&null!=this.geographyLayer.getMap()},n.prototype._addGeographyLayer=function(){return this.geographyLayer=new google.maps.FusionTablesLayer({query:{from:this.options.geographyTable.id,where:"type = 'city'"},map:this.map,suppressInfoWindows:!0,options:{styleId:this.options.geographyTable.style_id,templateId:this.options.geographyTable.template_id}}),this._initGeographyEvents()},n.prototype._setGeographyLayer=function(t){return this.geographyLayer.setOptions({query:{select:"geometry",from:this.options.geographyTable.id,where:t}}),this.closeInfoWindow()},n.prototype._attachEvents=function(){return this.idleListener=google.maps.event.addListener(this.map,"dragend",this._dispatchChange),this.zoomListener=google.maps.event.addListener(this.map,"zoom_changed",this._handleZoom)},n.prototype._detachEvents=function(){return google.maps.event.removeListener(this.idleListener),google.maps.event.removeListener(this.zoomListener)},n.prototype._dispatchChange=function(){return $(this).trigger("changed",this.values())},n.prototype._zoomGeography=function(t){var e,n;return this._detachEvents(),e=t.centroid,n="city"===t.type?this.options.zoom["default"]:this.options.zoom.neighborhood,this.map.setZoom(n),this.map.setCenter(new google.maps.LatLng(e[0],e[1])),this._handleZoom(),this._attachEvents()},n.prototype._highlightCurrentPolygon=function(){var t,e,n,o,a;return n=this._geoType(),t=this.getCenter(),o=this._reducePrecision(t.lat()),a=this._reducePrecision(t.lng()),e={containing:o+","+a,type:n},$.getJSON(this.options.geographiesUrl,e,function(t){return function(e){var o,a,i;return(null!=(i=e.geographies)?i.length:void 0)>0?(o=e.geographies[0],t.currentGeography=t._normalizeGeography(o,n),$(t).trigger("geography_changed",t.currentGeography),t.map.getZoom()>=t.options.zoom.neighborhood?(a=t.currentGeography.polygon,t._updatePolygon(t.currentGeography,a)):void 0):(t._setCurrentCity(""),t._setCurrentNeighborhood(""))}}(this))},n.prototype._geoType=function(){return this.map.getZoom()<this.options.zoom.showLabel?"city":"neighborhood"},n.prototype._reducePrecision=function(t,e){return null==e&&(e=1e3),Math.round(t*e)/e},n.prototype._updatePolygon=function(t,e){return null==this.currentPolygon||this.currentPolygon.geographyName!==t.name?(this._clearPolygon(),this.currentPolygon=this._getPolygon(e),this.currentPolygon.geographyName=t.name,this.currentPolygon.setMap(this.map)):void 0},n.prototype._clearPolygon=function(){return null!=this.currentPolygon?this.currentPolygon.setMap(null):void 0},n.prototype._getPolygon=function(t){var e,n;return n=function(){var n,o,a;for(a=[],n=0,o=t.length;o>n;n++)e=t[n],a.push(new google.maps.LatLng(e[0],e[1]));return a}(),new google.maps.Polygon({paths:n,strokeColor:"#797979",strokeOpacity:.8,strokeWeight:2,fillOpacity:0,clickable:!1})},n.prototype.highlightMarker=function(t){var e;return this.unhighlightListing(),this.currentListing=this.listingMarkers.filter(function(e){return e.listingId===t})[0],e=this.icons.get(this._iconType(this.currentListing.type),this._iconState("active",this.currentListing.openhouse)),this.currentListing.setIcon(e)},n.prototype.unhighlightListing=function(){var t;return null!=this.currentListing?(t=this.icons.get(this._iconType(this.currentListing.type),this._iconState("normal",this.currentListing.openhouse)),this.currentListing.setIcon(t)):void 0},n.prototype._addControls=function(){var t,e,n,o,a;return o=$("<div>"),n=REW.MapZoomControl("zoomcontrols",this.map,this.options.zoom.minZoom),n.addClass("mapcontrol hidden-xs hidden-sm"),e=$("<a/>",{"class":"btn btn--charcoal visible-xs visible-sm mapcontrol",href:"javascript:void(0);"}),t=$("<i/>",{"class":"icon-list-ul"}),e.append(t).on("click",function(t){return function(){return $(t).trigger("click.mapsearch.listsearch")}}(this)),o.append(n).append(e),this.map.controls[google.maps.ControlPosition.TOP_RIGHT].push(o.get(0)),a=REW.MapZoomControl("zoomcontrols",this.map,this.options.zoom.minZoom),a.addClass("visible-xs visible-sm zoomcontrols--mini mapcontrol"),this.map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(a.get(0))},n.prototype._addDevelopmentMarkers=function(){var t,e,n,o;return this.developments=function(){var a,i,r,s;for(r=this.options.developments,s=[],a=0,i=r.length;i>a;a++)t=r[a],n=new google.maps.LatLng(t.lat,t.lon),e=new google.maps.Marker({position:n,icon:this.developmentPin.get("development","visited")}),e.set("development",t),o=this,google.maps.event.addListener(e,"click",function(e){var n;return t=this.get("development"),o.closeInfoWindow(),n=HandlebarsTemplates.development_infobubble(t),o.infoBubble=new InfoBubble({map:o.map,content:n,backgroundColor:"#ffffff",borderRadius:0,hideCloseButton:!0,position:e.latLng,padding:0,minHeight:220,shadowStyle:1}),o.infoBubble.open(o.map)}),s.push(e);return s}.call(this)},n.prototype.showDevelopments=function(){return this._isDevelopmentsVisible()?void 0:this._setDevelopmentsMap(this.map)},n.prototype.hideDevelopments=function(){return this._setDevelopmentsMap(null)},n.prototype._setDevelopmentsMap=function(t){var e,n,o,a,i;for(a=this.developments,i=[],n=0,o=a.length;o>n;n++)e=a[n],i.push(e.setMap(t));return i},n.prototype._isDevelopmentsVisible=function(){var t;return"function"==typeof(t=this.developments)[0]?t[0](null!=getMap()):void 0},n.prototype.redraw=function(){return google.maps.event.trigger(this.map,"resize"),this.map.setZoom(this.map.getZoom())},n.prototype.setGeographySummary=function(t){return null!=this.infoBubble?this.infoBubble.setContent(this.infoBubble.getContent()):void 0},n.prototype.getCurrentGeography=function(t){return t(this.currentGeography)},n.prototype.getNearestGeography=function(t){var e,n,o;return null!=this.currentGeography?t(this.currentGeography):(o=this._geoType(),e=this.getCenter(),n={nearest:e.lat()+","+e.lng(),type:o},$.getJSON(this.options.geographiesUrl,n,function(e){return function(n){var a;return a=n.geographies[0],t(e._normalizeGeography(a,o))}}(this)))},n.prototype.getCenter=function(){return this.map.getCenter()},n.prototype.setListingMarkers=function(t){var e,n,o,a,i,r;return this._clearListingMarkers(),this.listingMarkers=function(){var s,l,h;for(h=[],s=0,l=t.length;l>s;s++)n=t[s],a=null!=n.next_openhouse,e=this.icons.get(this._iconType(n.property_type),this._iconState("normal",a)),i=new google.maps.LatLng(n.coordinates.lat,n.coordinates.lon),o=new google.maps.Marker({position:i,map:this.map,icon:e}),o.listingId=n.id,o.type=n.property_type,o.openhouse=a,o.listing=n,o.trackable_url=n.url+"?property_click=map",r=this,google.maps.event.addListener(o,"click",function(t){return r.highlightMarker(this.listingId),r._showListingInfoBubble(this,t.latLng)}),h.push(o);return h}.call(this)},n.prototype._clearListingMarkers=function(){var t,e,n,o,a;for(o=this.listingMarkers,a=[],t=0,e=o.length;e>t;t++)n=o[t],a.push(n.setMap(null));return a},n.prototype._iconType=function(t){return REW.PropertyPinSpriteMapper.map(t)},n.prototype._iconState=function(t,e){return e&&(t+="_open"),t},n.prototype._normalizeGeography=function(t,e){return{id:t.id,city:t.city_name,name:t.name,type:e,centroid:[t.centroid.latitude,t.centroid.longitude],polygon:t.polygon}},n}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.SearchFilterControls=function(){function e(e,n){this.map=e,this._handleKeywordsChange=t(this._handleKeywordsChange,this),this._dispatchChange=t(this._dispatchChange,this),this.setGeography=t(this.setGeography,this),$.extend(this.options,n),this.$openHouses=$(this.options.openHouseSelector),this.$priceFrom=$(this.options.priceFromSelector),this.$priceTo=$(this.options.priceToSelector),this.$sqftFrom=$(this.options.sqftFromSelector),this.$sqftTo=$(this.options.sqftToSelector),this.$yearBuiltFrom=$(this.options.yearBuiltFromSelector),this.$yearBuiltTo=$(this.options.yearBuiltToSelector),this.$bedroomsPicker=$(this.options.bedroomsSelector),this.$bathroomsPicker=$(this.options.bathroomsSelector),this.$propertyTypes=$(this.options.propertyTypesSelector),this.$keywords=$(this.options.keywordsSelector),this.$granularFilterContainer=$(this.options.granularFiltersSelector),this.$filterCounter=$(this.options.filterCounterSelector),this.$currentCity=$(this.options.currentCitySelector),this.$currentNeighborhood=$(this.options.currentNeighborhoodSelector),this._filters(),this._attachEvents()}return e.prototype.options={granularFiltersSelector:null,bedroomsSelector:null,bathroomsSelector:null,propertyTypesSelector:null,openHouseSelector:null,openHouseToggle:null,priceFromSelector:null,priceToSelector:null,sqftFromSelector:null,sqftToSelector:null,yearBuiltFromSelector:null,yearBuiltToSelector:null,keywordsSelector:null,filterCounterSelector:null,currentCitySelector:null,currentNeighborhoodSelector:null,labelSelectors:{propertyTypes:null,bedroms:null,price:null}},e.prototype.values=function(){var t,e,n,o,a,i,r,s,l,h;return e=this.$bedroomsPicker.val(),t=this.$bathroomsPicker.val(),i=this.$propertyTypes.val(),o=this.$priceFrom.val(),a=this.$priceTo.val(),r=this.$sqftFrom.val(),s=this.$sqftTo.val(),l=this.$yearBuiltFrom.val(),h=this.$yearBuiltTo.val(),n=this.$keywords.val(),{numBedrooms:e,numBathrooms:t,price:{from:o,to:a},sqft:{from:r,to:s},yearBuilt:{from:l,to:h},keywords:n,propertyTypes:i,openHouseOnly:this.$openHouses.prop("checked")}},e.prototype._setCounter=function(){var t;return t=this._getFilterCount(),this.$filterCounter.html(t),this.$filterCounter.toggleClass("is-visible",t>0)},e.prototype._getFilterCount=function(){var t,e;t=0;for(e in this.filters)"checkbox"===this.filters[e].type?this.filters[e].elem.prop("checked")!==this.filters[e]["default"]&&(t+=1):this.filters[e].elem.val()!==this.filters[e]["default"]&&(t+=1);return t},e.prototype.setValues=function(t){var e;return this._detachEvents(),e={numBedrooms:this.filters.numBedrooms["default"],numBathrooms:this.filters.numBathrooms["default"],price:{from:this.filters.priceFrom["default"],to:this.filters.priceTo["default"]},sqft:{from:this.filters.sqftFrom["default"],to:this.filters.sqftTo["default"]},yearBuilt:{from:this.filters.yearBuiltFrom["default"],to:this.filters.yearBuiltTo["default"]},openHouseOnly:this.filters.openHouseOnly["default"],propertyTypes:this.filters.propertyTypes["default"],keywords:this.filters.keywords["default"]},t=$.extend({},e,t),this.$priceFrom.selectpicker("val",this._emptyIfEqual(t.price.from,"")),this.$priceTo.selectpicker("val",this._emptyIfEqual(t.price.to,1e9)),this.$sqftFrom.selectpicker("val",this._emptyIfEqual(t.sqft.from,"")),this.$sqftTo.selectpicker("val",this._emptyIfEqual(t.sqft.to,1e9)),this.$yearBuiltFrom.selectpicker("val",this._emptyIfEqual(t.yearBuilt.from,"")),this.$yearBuiltTo.selectpicker("val",this._emptyIfEqual(t.yearBuilt.to,"")),this.$bedroomsPicker.selectpicker("val",""===t.numBedrooms?"0+":t.numBedrooms),this.$bathroomsPicker.selectpicker("val",this._emptyIfEqual(t.numBathrooms,"")),this.$keywords.val(t.keywords),this.$propertyTypes.selectpicker("val",t.propertyTypes),this.options.openHouseToggle.setState(t.openHouseOnly),this._setCounter(),this._attachEvents()},e.prototype.setGeography=function(t){var e;return e="city"===t.type,this.$currentCity.html(t.city),this.$currentNeighborhood.html(t.name),this.$currentNeighborhood.parent().toggleClass("hidden",e)},e.prototype._emptyIfEqual=function(t,e){return t===e?"":t},e.prototype._filters=function(){return this.filters||(this.filters={numBedrooms:{elem:this.$bedroomsPicker,"default":"0+"},numBathrooms:{elem:this.$bathroomsPicker,"default":"0+"},priceFrom:{elem:this.$priceFrom,"default":""},priceTo:{elem:this.$priceTo,"default":""},sqftFrom:{elem:this.$sqftFrom,"default":""},sqftTo:{elem:this.$sqftTo,"default":""},yearBuiltFrom:{elem:this.$yearBuiltFrom,"default":""},yearBuiltTo:{elem:this.$yearBuiltTo,"default":""},openHouseOnly:{elem:this.$openHouses,"default":!1,type:"checkbox"},propertyTypes:{elem:this.$propertyTypes,"default":""},keywords:{elem:this.$keywords,"default":""}})},e.prototype._attachEvents=function(){var t;for(t in this.filters)this.filters[t].elem.on("change",this._dispatchChange);return this.$keywords.on("keyup",this._handleKeywordsChange)},e.prototype._detachEvents=function(){var t;for(t in this.filters)this.filters[t].elem.off("change",this._dispatchChange);return this.$keywords.off("keyup",this._handleKeywordsChange)},e.prototype._dispatchChange=function(t){return $(this).trigger("changed",this.values())},e.prototype._handleKeywordsChange=function(){return clearTimeout(this.keywordTimer),this.keywordTimer=setTimeout(function(t){return function(){return t._dispatchChange()}}(this),300)},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.MapSearchListings=function(){function e(e){this._handleListingClick=t(this._handleListingClick,this),this._handleMouseLeave=t(this._handleMouseLeave,this),this._handleMouseEnter=t(this._handleMouseEnter,this),this._handlePageClick=t(this._handlePageClick,this),this._handleSortChange=t(this._handleSortChange,this),this._renderResults=t(this._renderResults,this),this._handleResultsCountChanged=t(this._handleResultsCountChanged,this),$.extend(this.options,e),this.$el=$(this.options.listingsSelector),this.$prev=$(this.$el.find("[data-pagination-page]").get(0)),this.$next=$(this.$el.find("[data-pagination-page]").get(1)),this.$paginationCaption=this.$el.find("[data-pagination-caption]"),this.$paginationMenu=this.$el.find("[data-pagination-menu]"),this.resultsCaption=$(this.options.resultsCaption),this.$resultsCount=$(this.options.resultsCount),this.$resultsCurrentCount=$(this.options.resultsCurrentCount),this.$resultsRange=this.$el.find("[data-results-range]"),this.$resultsEmpty=$(this.options.resultsEmpty),this.$resultsSorting=$(this.options.resultsSorting),this.$sidebarSelector=$(this.options.sidebarSelector),this.searchUrl=this.$el.data("search-url"),this._attachEvents(),this.currentSort="featured",this.currentDirection="desc",this.currentPage=1,this.totalPages=1,this.$el.on("mouseenter","article",this._handleMouseEnter).on("mouseleave","article",this._handleMouseLeave).on("click","article",this._handleListingClick)}return e.prototype.options={listingsSelector:null,resultsCaption:null,resultsCount:null,resultsCurrentCount:null,resultsEmpty:null,resultsSorting:null,sidebarSelector:null},e.prototype.setValues=function(t){return this.setCurrentPage(parseInt(t.page,10)||1),this.currentSort=t.sort||"featured",this._highlightActivesort(),this.currentDirection=t.direction||"desc",null!=t.bounds?$.ajax({url:this.searchUrl,data:t,success:this._renderResults,dataType:"jsonp"}):void 0},e.prototype.values=function(){return{sort:this.currentSort,direction:this.currentDirection,page:this.currentPage}},e.prototype._handleResultsCountChanged=function(t){var e;return this.$resultsCount.html(t.total_results),e=t.total_results>0,this.$paginationMenu.toggleClass("hidden",!e),this.$resultsEmpty.toggleClass("hidden",e),this.$resultsSorting.toggleClass("hidden",!e),this.resultsCaption.toggleClass("hidden",!e)},e.prototype._renderResults=function(t){var e,n,o;return this.$sidebarSelector.scrollTop(0),this._setTotalPages(t.total_pages),this.$paginationCaption.html(t.pagination_caption),this.$resultsRange.html(t.current_results),this._handleResultsCountChanged(t),e=function(){var e,a,i,r;for(i=t.listings,r=[],e=0,a=i.length;a>e;e++)o=i[e],n={"class":"infobubble--listingsidebar",isVreb:"vreb"===o.mls_system,trackable_url:o.url+"?property_click=map_sidebar"},r.push($(HandlebarsTemplates.listing($.extend(n,o))).data("listing",o));return r}(),this.$el.find("[data-listing-container]").html(e),this.setCurrentPage(t.page),$(this).trigger("listings_changed",[t.listings])},e.prototype._attachEvents=function(){return this.$el.find("[data-sort]").change(this._handleSortChange),this.$el.find("[data-pagination-page]").on("click",this._handlePageClick)},e.prototype._handleSortChange=function(t){var e,n;return e=$(t.target),n=e.val().split("_"),this.currentSort=n[0],this.currentDirection=n[1],this.currentPage=1,$(this).trigger("changed")},e.prototype._handlePageClick=function(t){var e;return t.preventDefault(),e=$(t.target),e.hasClass("is-disabled")?void 0:(this.currentPage=e.data("pagination-page"),$(this).trigger("changed"))},e.prototype._toggleDirection=function(){return this.currentDirection="desc"===this.currentDirection?"asc":"desc"},e.prototype.setCurrentPage=function(t){return this.currentPage=parseInt(t,10)||1,this.$prev.data("pagination-page",this.currentPage-1).removeClass("is-disabled"),this.$next.data("pagination-page",this.currentPage+1).removeClass("is-disabled"),1===this.currentPage&&this.$prev.addClass("is-disabled"),this.currentPage>=this.totalPages?this.$next.addClass("is-disabled"):void 0},e.prototype._setTotalPages=function(t){return this.totalPages=parseInt(t||1,10)},e.prototype._handleMouseEnter=function(t){var e;return e=$(t.currentTarget),this._setActiveListing(e)},e.prototype._handleMouseLeave=function(t){var e;return e=$(t.currentTarget),e.removeClass("is-active")},e.prototype._handleListingClick=function(t){var e;return e=$(t.currentTarget),this._setActiveListing(e)},e.prototype._setActiveListing=function(t){var e;return t.addClass("is-active"),e=t.data("listing"),$(this).trigger("listing_activated",e)},e.prototype._highlightActivesort=function(){return this.$el.find("[data-sort]").removeClass("active"),this.$el.find("[data-sort='"+this.currentSort+"']").addClass("active")},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.QueryToHash={parse:function(t){var e,n,o,a,i,r,s;if(i={},o=t.match(/.*\?(.*)/),null==o)return{};for(r=o[1].split("&"),e=0,n=r.length;n>e;e++)a=r[e],s=a.split("="),i[decodeURIComponent(s[0])]=decodeURIComponent(s[1]);return i}}}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.MapSearchController=function(){function e(e,n){this._goToListSearch=t(this._goToListSearch,this),this._resetFilters=t(this._resetFilters,this),this._handleListingsChanged=t(this._handleListingsChanged,this),this._handleListingActivated=t(this._handleListingActivated,this),this._pushState=t(this._pushState,this),this._handleZoomChange=t(this._handleZoomChange,this),this._setGeographyName=t(this._setGeographyName,this),this._handleStateChanged=t(this._handleStateChanged,this),$.extend(this.options,n),this.geographyCache=new REW.Cache(10),this.$el=$(e),this.map=new REW.MapSearch(this.options.mapSelector,this.options),this.filterControls=new REW.SearchFilterControls(this.map,this.options),this.listings=new REW.MapSearchListings(this.options),this.stateChanges=0,this.$el.on("submit",function(){return!1}),$(window).on("statechange",this._handleStateChanged),$(this.map).on("mapready",this._handleStateChanged).on("zoom_changed",this._handleZoomChange).on("geography_changed",this._setGeographyName).on("click.mapsearch.listsearch",this._goToListSearch),$(this.listings).on("listing_activated",this._handleListingActivated).on("listings_changed",this._handleListingsChanged),$(this.options.resetFiltersButton).click(this._resetFilters),this.$el.find("[data-list-search-toggle]").click(this._goToListSearch),this._attachEvents()}return e.prototype.options={key:null,geographyTable:null,geographiesUrl:null,granularFiltersSelector:null,priceFromSelector:null,priceToSelector:null,sqftFromSelector:null,sqftToSelector:null,keywordsSelector:null,bedroomsSelector:null,bathroomsSelector:null,propertyTypesSelector:null,openHouseSelector:null,currentCitySelector:null,resetFiltersButton:null,currentNeighborhoodSelector:null,advancedFiltersToggle:null,labelSelectors:{propertyTypes:null,bedroms:null,price:null},locationSelector:null,mapSelector:null,listingsSelector:null,developments:[],developmentIcon:{url:null,x:0,y:0,width:null,height:null},disclaimersSelector:null,showPinsZoomLevel:13,neighborhoodZoomLevel:15},e.prototype._attachEvents=function(){return $(this.map).on("changed",this._pushState),$(this.filterControls).on("changed",this._pushState),$(this.listings).on("changed",this._pushState)},e.prototype._detachEvents=function(){return $(this.filterControls).off("changed",this._pushState),$(this.map).off("changed",this._pushState),$(this.listings).off("changed",this._pushState)},e.prototype._handleStateChanged=function(){var t,e;return this._detachEvents(),t=History.getState(),e=REW.QueryToHash.parse(t.url),e=this._normalize(e),
this.filterControls.setValues(e),this.map.setValues(e),this.listings.setValues($.extend({},this.map.values(),this.filterControls.values(),e)),this._attachEvents()},e.prototype._setGeographyName=function(t,e){return this.filterControls.setGeography(e)},e.prototype._handleZoomChange=function(t,e){return this._pushState()},e.prototype._pushState=function(t){return(null!=t?t.target:void 0)!==this.listings&&(this.stateChanges++,this.listings.setCurrentPage(1)),History.pushState(null,History.options.initialTitle,"?"+$.param(this._denormalize()))},e.prototype._normalize=function(t){return{zoom:parseInt(t.zoom,10),lat:t.lat,lng:t.lng,bounds:{sw:t["bounds[sw]"],ne:t["bounds[ne]"]},numBedrooms:t.numBedrooms,numBathrooms:t.numBathrooms,price:{from:t.priceFrom,to:t.priceTo},propertyTypes:this.map.mappedPropertyTypes(t.propertyTypes),sqft:{from:t.sqftFrom,to:t.sqftTo},yearBuilt:{from:t.yearBuiltFrom,to:t.yearBuiltTo},keywords:t.keywords,openHouseOnly:"true"===t.openHouseOnly,sort:t.sort,direction:t.direction,page:parseInt(t.page,10)||1}},e.prototype._denormalize=function(){var t,e,n;return n=this.map.values(),t=this.filterControls.values(),e=this.listings.values(),$.extend(n,e,{numBedrooms:t.numBedrooms,numBathrooms:t.numBathrooms,priceFrom:t.price.from,priceTo:t.price.to,sqftFrom:t.sqft.from,sqftTo:t.sqft.to,yearBuiltFrom:t.yearBuilt.from,yearBuiltTo:t.yearBuilt.to,keywords:t.keywords,propertyTypes:t.propertyTypes,openHouseOnly:t.openHouseOnly})},e.prototype._handleListingActivated=function(t,e){return this.map.highlightMarker(e.id)},e.prototype._handleListingsChanged=function(t,e){var n,o,a;return this.map.setListingMarkers(e),n=$(this.options.disclaimersSelector),a="vreb"===(null!=(o=e[0])?o.mls_system:void 0),n.find("[data-disclaimer=vreb]").toggle(a),n.find("[data-disclaimer=brc]").toggle(!a)},e.prototype._resetFilters=function(){return this.filterControls.setValues(),this._pushState()},e.prototype._goToListSearch=function(){return this.map.getNearestGeography(function(t){return function(e){var n,o;return n=t.stateChanges>1,o=t._denormalize(),o.nearestGeography=e,$(t).trigger("click.mapsearchcontroller.listsearch",[n,o])}}(this))},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.MapViewControls=function(){function t(t,e){this.$el=$(t),this.map=e,this._attachEvents()}return t.prototype._attachEvents=function(){return this.$el.on("click","a",function(t){return function(e){var n,o,a,i,r;switch(e.preventDefault(),t.$el.find("li").removeClass("active"),n=$(e.target),n.parent("li").addClass("active"),i=n.data("mode"),r=t.map.getStreetView(),i){case"satellite":return t.map.setMapTypeId(google.maps.MapTypeId.SATELLITE),r.setVisible(!1);case"street":return o=parseFloat($(".mapcontrols meta[itemprop=latitude]").attr("content"),10),a=parseFloat($(".mapcontrols meta[itemprop=longitude]").attr("content"),10),r.setPosition(new google.maps.LatLng(o,a)),r.setVisible(!0);default:return t.map.setMapTypeId(google.maps.MapTypeId.ROADMAP),r.setVisible(!1)}}}(this))},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.MapZoomControl=function(t,e,n){var o,a,i,r,s;return o=$("<div>",{"class":t}),a=$("<div>",{title:"Zoom in"}),i=$("<span>",{"class":t+"-in"}),o.append(a.append(i)),r=$("<div>",{title:"Zoom out"}),s=$("<span>",{"class":t+"-out"}),o.append(r.append(s)),o[0].index=1,google.maps.event.addDomListener(r[0],"click",function(){var t;return t=e.getZoom(),t>n?e.setZoom(t-1):void 0}),google.maps.event.addDomListener(a[0],"click",function(){return e.setZoom(e.getZoom()+1)}),o}}.call(this),function(){null==window.REW&&(window.REW={}),REW.ModalTabSelector=function(t,e){return $(t).modal("show"),$(e).tab("show")}}.call(this),function(){null==window.REW&&(window.REW={}),REW.MonthToggler=function(t){var e;return e=$(t),e.on("change",function(){return $(this).parents("form").submit()})},$(function(){return REW.MonthToggler("[data-monthtoggler]")})}.call(this),function(){null==window.REW&&(window.REW={}),REW.MortgageCalculator=function(){function t(t,e,n,o){this.chartEngine=n,this.$mortgageForm=t,this.chartOptions=o,this.$leadForm=e,this._setDownPayment(),this.calculate(),this.$mortgageForm.submit(function(t){return function(e){return e.preventDefault(),t.calculate()}}(this)),this.calculateButton=this.$mortgageForm.find(".calculate-mortgage"),this.calculateButton.click(function(t){return function(){return t.calculate()}}(this)),this.clearButton=this.$mortgageForm.find(".clear"),this.clearButton.click(function(t){return function(){return t.clearForm()}}(this)),this.formatCurrency(),this.$mortgageForm.delegate("input","keyup",function(t){return function(e){return t.formatCurrency()}}(this))}return t.prototype._initData=function(){return this.data={listingPrice:0,downPayment:0,mortgageRate:0,amortizationPeriod:0,mortgageAmount:0,monthlyPayment:0,numberOfPayment:0,totalPayment:0,totalInterestPayment:0,totalPrincipalPayment:0,monthlySchedule:[],yearlySchedule:[]}},t.prototype.getChartData=function(){var t,e,n,o,a,i,r,s,l,h;for(t=[this.chartOptions.data_column_titles],e=a=0,h=this.data.amortizationPeriod;h>=0?h>a:a>h;e=h>=0?++a:--a)i=Math.round(this.data.yearlySchedule[e].newBalance),r=this.chartOptions.mortgage_balance_tooltip_text+" "+this.numberToMoney(i,0),s=Math.round(this.data.yearlySchedule[e].principalPaidTotal),l=this.chartOptions.principal_paid_tooltip_text+" "+this.numberToMoney(s,0),n=Math.round(this.data.yearlySchedule[e].interestPaidTotal),o=this.chartOptions.interest_paid_tooltip_text+" "+this.numberToMoney(n,0),t.push([e+1,this.chartOptions.year,i,r,s,l,n,o]);return t},t.prototype.calculate=function(){var t,e,n,o;for(this._initData(),this._fetchValues(),this._calculateMonthlyPayment(this.data.listingPrice-this.data.downPayment),this._populateMonthlySchedule(),this._populateYearlySchedule(),e=n=0,o=this.data.amortizationPeriod;o>=0?o>n:n>o;e=o>=0?++n:--n)this.data.totalPayment+=this.data.yearlySchedule[e].paymentTotal,this.data.totalInterestPayment+=this.data.yearlySchedule[e].interestPaidTotal,this.data.totalPrincipalPayment+=this.data.yearlySchedule[e].principalPaidTotal;return t=this.getChartData(),this.chartEngine.setChartData(t),this._showResult(),this._setLeadForm(),this.chartEngine.draw()},t.prototype.getMonthlyPayment=function(){return this.data.monthlyPayment},t.prototype._showResult=function(){return this.$mortgageForm.find(".mortgage-amount").text(Math.round(this.data.mortgageAmount)).formatCurrency({roundToDecimalPlace:0}),this.$mortgageForm.find(".monthly-payment").text(Math.round(this.data.monthlyPayment)).formatCurrency({roundToDecimalPlace:0}),this.$mortgageForm.find(".listing-price").text(Math.round(this.data.monthlyPayment)).formatCurrency({roundToDecimalPlace:0})},t.prototype._fetchValues=function(){return this.data.listingPrice=parseInt(this.$mortgageForm.find(".listing-price").val().replace(/\D/g,"")),this.data.downPayment=parseInt(this.$mortgageForm.find(".down-payment").val().replace(/\D/g,""))||0,this.data.mortgageRate=parseFloat(this.$mortgageForm.find(".mortgage-rate").val()),this.data.amortizationPeriod=parseInt(this.$mortgageForm.find(".amortization-period").val()),this.data.mortgageAmount=this.data.listingPrice-this.data.downPayment,this.data.numberOfPayment=12*this.data.amortizationPeriod},t.prototype._setLeadForm=function(){return this.$leadForm.find(".down-payment").val(this.data.downPayment),this.$leadForm.find(".mortgage-rate").val(this.data.mortgageRate),this.$leadForm.find(".amortization-period").val(this.data.amortizationPeriod),this.$leadForm.find(".monthly-payment").val(this.data.monthlyPayment),this.$leadForm.find(".mortgage-amount").val(this.data.mortgageAmount)},t.prototype._setDownPayment=function(){return this.$mortgageForm.find(".down-payment").val(.2*parseInt(this.$mortgageForm.find(".listing-price").val().replace(/\D/g,"")))},t.prototype.clearForm=function(t){return this.$mortgageForm.find("input:text").val(""),this.$mortgageForm.find(".monthlyPayment").text(""),this.$mortgageForm.find(".mortgageAmount").text("")},t.prototype.formatCurrency=function(){return this.$mortgageForm.find(".down-payment").formatCurrency({roundToDecimalPlace:0}),this.$mortgageForm.find(".listing-price").formatCurrency({roundToDecimalPlace:0})},t.prototype.numberToMoney=function(t,e){var n,o,a,i,r,s;return e=isNaN(n=Math.abs(e))?2:e,o=".",s=",",r=0>t?"-":"",a=parseInt(t=Math.abs(+t||0).toFixed(e))+"",i=(i=a.length)>3?i%3:0,"$"+r+(i?a.substr(0,i)+s:"")+a.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+s)+(e?o+Math.abs(t-a).toFixed(n).slice(2):"")},t.prototype._calculateMonthlyPayment=function(t){var e,n,o;return o=t,n=this.data.numberOfPayment,e=this.data.mortgageRate/12/100,this.data.monthlyPayment=o*e*Math.pow(1+e,n)/(Math.pow(1+e,n)-1)},t.prototype._populateMonthlySchedule=function(){var t,e,n,o,a,i,r,s,l,h,u;for(s=this.data.numberOfPayment,this.data.mortgageAmount=this.data.listingPrice-this.data.downPayment,i=this._calculateMonthlyPayment(this.data.mortgageAmount),r=this.data.mortgageRate/12/100,u=[],e=o=0,h=s;h>=0?h>o:o>h;e=h>=0?++o:--o)t=0===e?this.data.mortgageAmount:this.data.monthlySchedule[e-1].newBalance,a={},a.payment=i,n=t*r,a.interestPaid=n,l=i-n,a.principalPaid=l,a.newBalance=t-l,u.push(this.data.monthlySchedule.push(a));return u},t.prototype._populateYearlySchedule=function(){var t,e,n,o,a,i,r,s,l,h,u,c,p,d,f,g,m;for(s=this.data.listingPrice-this.data.downPayment,f=[],n=i=0,c=this.data.amortizationPeriod;c>=0?c>i:i>c;n=c>=0?++i:--i){for(h=0,o=0,u=0,t=0===n?s:this.data.yearlySchedule[n-1].newBalance,g=12*n,e=g+12,a=r=p=g,d=e;d>=p?d>r:r>d;a=d>=p?++r:--r)h+=this.data.monthlySchedule[a].payment,o+=this.data.monthlySchedule[a].interestPaid,u+=this.data.monthlySchedule[a].principalPaid;m={paymentTotal:h,interestPaidTotal:o,principalPaidTotal:u},l=t-u,1>l&&(l=0),m.newBalance=l,f.push(this.data.yearlySchedule.push(m))}return f},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.MortgageChart=function(){function t(t,e,n){this.chartEngine=t,this.chartDiv=e,this.options.title=n.graph_title,this.options.vAxes[0].title=n.y_axes_left_title,this.options.vAxes[1].title=n.y_axes_right_title,this.options.vAxis[0]=n.y_axes_left_title,this.options.vAxis[1]=n.y_axes_right_title,this.options.hAxis.title=n.year}return t.prototype.dataAsArray=[],t.prototype.options={title:"",titlePosition:"out",titleTextStyle:{color:"black",fontSize:"15"},legend:{position:"top",textStyle:{fontSize:9.5}},vAxes:{0:{logScale:!1,title:""},1:{logScale:!1,title:""}},series:{0:{targetAxisIndex:0,type:"line",pointSize:5},1:{targetAxisIndex:1},2:{targetAxisIndex:1},3:{targetAxisIndex:1}},vAxis:{0:"",1:""},hAxis:{title:""},colors:["#008000","#FC8A15","#1791D8"],isStacked:!0,backgroundColor:"white","backgroundColor.stroke":"#666"},t.prototype.setChartData=function(t){return this.dataAsArray=t},t.prototype.draw=function(){var t,e;return t=google.visualization.arrayToDataTable(this.dataAsArray),t.setColumnProperty(1,"role","tooltip"),t.setColumnProperty(3,"role","tooltip"),t.setColumnProperty(5,"role","tooltip"),t.setColumnProperty(7,"role","tooltip"),e=new google.visualization.DataView(t),new this.chartEngine.visualization.ColumnChart(this.chartDiv).draw(e,this.options)},t}()}.call(this),function(){var t;t=function(){var t,e,n,o,a,i;return n=$(".mortgageform"),i=n.data("chart-options"),t=$(".mortgageform-chart").get(0),o=new REW.MortgageChart(google,t,i),e=$(".mortgageform-sender"),a=new REW.MortgageCalculator(n,e,o,i),e.each(function(t,e){var n,o;return n=$(e),o=n.parents(".modal"),new REW.AjaxFormSubmitter(n,{onBeforeSend:function(){return n.find(".help-block, .alert").remove(),n.find(".form-group").removeClass("error")},onSuccess:function(t){return new REW.Notification("success",t.message),o.modal("hide"),REW.Tracking.mortgageRateRequest()},onError:function(t,e){var o,a,i,r;r=e.errors;for(i in r)t=r[i],o=n.find('[name$="['+i+']"]'),a=o.parents(".form-group"),a.addClass("error"),o.after('<div class="help-block">'+t+"</div>");return e.errors.base?n.prepend("<div class='alert alert-danger'>"+e.errors.base+"</div>"):void 0}})})},$(function(){var e;return e=$(".mortgageform"),e.length>0&&"undefined"!=typeof google&&null!==google?google.load("visualization","1",{packages:["corechart"],callback:t}):void 0})}.call(this),function(){null==window.REW&&(window.REW={}),REW.MultiAssetUploader=function(){function t(t,e){null==e&&(e={}),this.$el=$(t),this.options=$.extend({},this.defaultOptions,e),this.$inputField=this.$el.find("input"),this.$progressBar=this.$el.find("[data-asset-uploader=progress]"),this.$inputField.on("cloudinarydone",function(t){return function(e,n){var o,a;return o=n.result,a=["image/upload","v"+o.version,[[o.public_id,o.format].join("."),o.signature].join("#")].join("/"),t.options.onAdd(a,n.result)}}(this)).on("fileuploadsend",function(t){return function(e){return t.$progressBar.removeClass("hidden"),t.$el.find(".cloudinary-fileupload").hide()}}(this)).on("fileuploadprogress",function(t){return function(e,n){var o;return o=Math.round(100*n.loaded/n.total)+"%",t.$progressBar.find(".attachmentbuttons-progress_bar").css({width:o}),t.$progressBar.find(".attachmentbuttons-progress_label").html(o)}}(this)).on("fileuploadalways",function(t){return function(e){return t.$progressBar.addClass("hidden"),t.$el.find(".cloudinary-fileupload").show()}}(this))}return t.prototype.defaultOptions={onAdd:function(t,e,n){}},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.NeighbourhoodSelector=function(){function e(e,n){this._handleApply=t(this._handleApply,this),this._handleChange=t(this._handleChange,this),this.$container=$(e),this.$elements=this.$container.find("input[type=checkbox]"),this.options=$.extend(this.options,n),this.$elements.on("change",this._handleChange),this.$container.on("click","[data-selector-button]",this._handleApply)}return e.prototype.options={onChange:function(t){},onApply:function(t){}},e.prototype.setSelected=function(t,e){return null==e&&(e=!0),e&&this.$elements.prop("checked",!1),this._setProp(t,"checked",!0)},e.prototype.getSelected=function(){var t,e;return t=this.$elements.filter(":checked"),e=[],t.map(function(t,n){var o;return o=$(n),e=e.concat(o.data("children")),-1===e.indexOf(parseInt(o.val(),10))?{id:o.val(),text:o.parent().text()}:void 0})},e.prototype._handleChange=function(t){return this._toggleChildren(t.target),this.options.onChange(t)},e.prototype._handleApply=function(t){return t.preventDefault(),this.options.onApply(this.getSelected())},e.prototype._toggleChildren=function(t){var e,n;return e=$(t),n=e.data("children"),n?(this._setProp(n,"disabled",e.is(":checked")),this._setProp(n,"checked",e.is(":checked"))):void 0},e.prototype._setProp=function(t,e,n){var o,a,i,r,s;for(s=[],a=0,r=t.length;r>a;a++)i=t[a],o=this.$elements.filter("[value="+i+"]"),o.prop(e,n),s.push(this._toggleChildren(o));return s},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.NewsletterSubscriptionWidget=function(){function e(e){this._handleError=t(this._handleError,this),this._handleSuccess=t(this._handleSuccess,this),this._handleSubmit=t(this._handleSubmit,this),this.$el=$(e),this.$form=this.$el.find("form"),this.$form.on("submit",this._handleSubmit)}return e.prototype._handleSubmit=function(t){var e;return t.preventDefault(),e=$.post(this.$form.attr("action"),{email:this._getEmail()},this._handleSuccess),e.fail(this._handleError)},e.prototype._getEmail=function(){return this.$form.find("input[type='text']").val()},e.prototype._handleSuccess=function(t){return this.$el.find(".newsletterwidget-body").html(t)},e.prototype._handleError=function(t){var e,n;return n=function(){switch(t.status){case 500:return"error";case 422:return"warning"}}(),e=HandlebarsTemplates.notifications({type:n,body:t.responseText}),this.$el.find(".newsletterwidget-body p").html(e)},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.Notification=function(){function t(t,e,n){var o;this.options=$.extend({},this.defaultOptions,n),o=$(REW.Templates.notifications({type:t,body:e})),$(this.options.container).append(o),this.options.delay>0&&window.setTimeout(function(){return o.alert("close")},this.options.delay)}return t.prototype.defaultOptions={delay:0,container:"[data-notifications-bar]"},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.NotificationCloser=function(t){return null==t&&(t=15e3),window.setTimeout(function(){return $("[data-notifications-bar] .alert").alert("close")},t)},$(function(){return REW.NotificationCloser()})}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.Offcanvas=function(){function e(e,n){this._hide=t(this._hide,this),$.extend(this.options,n),this.$body=$("body"),this.$el=$(e),this.$target=$(this.$el.data("target")),this._setupBackdrop(),this._attachListeners()}return e.prototype.options={bodyClass:"offcanvas-in"},e.prototype._setupBackdrop=function(){return this.$backdrop=$("<div></div>",{"class":"offcanvas-backdrop"}).insertAfter(this.$target),this.$backdrop.hide(),this.$backdrop.on("click swipeleft",this._hide)},e.prototype._attachListeners=function(){return this.$el.on("click",function(t){return function(){return t.$body.addClass(t.options.bodyClass),t.$target.addClass("is-visible"),t.$backdrop.show()}}(this)),this.$target.on("swipeleft",this._hide)},e.prototype._hide=function(){return this.$body.removeClass(this.options.bodyClass),this.$target.removeClass("is-visible"),this.$backdrop.hide()},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function o(){this.constructor=t}for(var a in e)n.call(e,a)&&(t[a]=e[a]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;null==window.REW&&(window.REW={}),REW.OpenHouseMap=function(n){function o(e,n){this._hoverOut=t(this._hoverOut,this),this._hoverIn=t(this._hoverIn,this),this._closeInfoBubble=t(this._closeInfoBubble,this),this._redirectToList=t(this._redirectToList,this),this._zoomIn=t(this._zoomIn,this),this._handleActionClick=t(this._handleActionClick,this),n=$.extend({},this.options,n,{zoomBreakPoint:12,center:{lat:49.2419,lon:-123.0233},mapOptions:{zoom:11,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,panControl:!1},onClusterClick:function(t){return function(e){var n;return t._closeInfoBubble(),n=$(HandlebarsTemplates.map_actions({actions:t.clusterActions,location:e.geocodeData.name,count:e.geocodeData.count})).on("click","a",t._handleActionClick).data("marker",e),t.infoBubble=new InfoBubble({content:n.get(0),hideCloseButton:!0,position:e.getPosition(),arrowSize:10,arrowPosition:50,borderRadius:3,minHeight:85}),t.infoBubble.open(t.getMap())}}(this),onClick:function(t){return function(e,n){return t._closeInfoBubble(),t.infoBubble=new REW.AJAXInfoBubble({url:e.url+"?summary=true",template:HandlebarsTemplates.listing_infobubble,defaults:{labels:t.options.labels},map:t.getMap(),marker:n,bubbleOptions:{backgroundColor:"#ffffff",borderRadius:0,hideCloseButton:!0,padding:0,shadowStyle:1,maxWidth:188,minHeight:130,maxHeight:230}})}}(this),onResize:null}),o.__super__.constructor.call(this,e,n),google.maps.event.addListener(this.getMap(),"click",this._closeInfoBubble),$("[data-geography]").hover(this._hoverIn,this._hoverOut),this.clusterActions=[{title:"Zoom In",handler:this._zoomIn},{title:"List View",handler:this._redirectToList}]}return e(o,n),o.prototype.options={clusterMarkerData:[],markerData:[],clusterIconUrl:null,clusterIconUrlHover:null,clusterIconSize:null,labels:{}},o.prototype.infobubble=null,o.prototype._handleActionClick=function(t){var e,n,o;return t.preventDefault(),e=$(t.target),n=e.parent().index(),o=$(t.delegateTarget).data("marker"),this._closeInfoBubble(),this.clusterActions[n].handler(o)},o.prototype._zoomIn=function(t){return this.getMap().setCenter(t.getPosition()),this.getMap().setZoom(13)},o.prototype._redirectToList=function(t){return window.location=t.geocodeData.url},o.prototype._closeInfoBubble=function(){return this.infoBubble?this.infoBubble.close():void 0},o.prototype._hoverIn=function(t){var e;return e=$(t.currentTarget).data("geography"),e?this.setIcon(e,this.options.clusterIconUrlHover):void 0},o.prototype._hoverOut=function(t){var e;return e=$(t.currentTarget).data("geography"),e?this.setIcon(e,this.options.clusterIconUrl):void 0},o}(REW.ClusteredMap)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.OutOfBoundsModal=function(){function e(e){this._dismissForever=t(this._dismissForever,this);var n,o;$.extend(this.options,e),$.cookie("dismissMapHelp")||localStorage.getItem(this.options.key,"true")||(o=$(HandlebarsTemplates.out_of_bounds_modal()),$("body").append(o),n=o.find("[data-helpscreen-checkbox]"),o.modal({show:!0}).on("hidden.bs.modal",function(t){return function(){return o.remove(),$.cookie("dismissMapHelp",!0),n.is(":checked")?t._dismissForever():void 0}}(this)))}return e.prototype.options={key:null},e.prototype._dismissForever=function(){return localStorage.setItem(this.options.key,"true")},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.PhoneMasked=function(t){var e;return e=t+"-button",$(e).each(function(e){return function(e,n){return $(n).on("click",function(e){return $(n).parent(t).addClass("is-shown")})}}(this))}}.call(this),function(){null==window.REW&&(window.REW={}),REW.Popover=function(){function t(t){this.selector||(this.selector=t),$(this.selector).popover({placement:"bottom",trigger:"manual",title:null,html:!0,container:"body",content:function(t){var e;return e=$($(this).data("target")),e.html().trim()}}).click(function(t){return function(e){var n;return e.preventDefault(),e.stopImmediatePropagation(),n=$(e.target),n.popover("show"),n.trigger("shown"),t.popoverOpen=!0}}(this)),$(document).click(function(t){return function(e){return t.popoverOpen?$(".popover").fadeOut():void 0}}(this))}return t.prototype.popoverOpen=!1,t.prototype.selector="[data-popover]",t}(),$(function(){return new REW.Popover})}.call(this),function(){null==window.REW&&(window.REW={}),REW.PropertyPinSpriteMapper={_mappings:{condo:["apartment_condo"],house:["chalet","house"],townhouse:["duplex","fourplex","half_duplex","multifamily","townhouse","triplex"]},_defaultIcon:"other",map:function(t){var e,n;n=this._defaultIcon;for(e in this._mappings)this._mappings[e].indexOf(t)>=0&&(n=e);return n}}}.call(this),function(){var t=function(t,n){function o(){this.constructor=t}for(var a in n)e.call(n,a)&&(t[a]=n[a]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t},e={}.hasOwnProperty;null==window.REW&&(window.REW={}),REW.PropertyMap=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaultOptions={icons:null,maxWidth:188,minHeight:210,sprites:{property:{url:null,x:0,y:0,width:null,height:null}},defaultStates:{active:"active",normal:"normal"},labels:{beds:null,bathrooms:null,square_feet:null,link:null}},n.prototype.templates={property:HandlebarsTemplates.listing_infobubble},n.prototype._iconType=function(t){return REW.PropertyPinSpriteMapper.map(t.property_type)},n.prototype._iconState=function(t,e){var n;return null==e&&(e=this.options.defaultStates.normal),n=e,t.next_openhouse&&(n+="_open"),n},n}(REW.MarkerInfobubbles)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.Pulltab=function(){function e(e){this.toggle=t(this.toggle,this);var n;this.$el=$(e),n=this.$el.find(".pulltab-handle"),n.on("click",this.toggle)}return e.prototype.toggle=function(t){return this.$el.toggleClass("is-hidden"),this.$el.hasClass("is-hidden")?this.$el.trigger("pulltab.collapsed"):this.$el.trigger("pulltab.expanded")},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.QuickSearch=function(){function t(t){this.$form=$(t),this.$input=this.$form.find("input[type=text]"),this.$form.on("submit",function(t){return function(e){return""===t.$input.val()?(e.preventDefault(),!1):void 0}}(this)).on("ajax:success",function(t,e,n,o){"ok"===e.status?window.location=e.path:"error"===e.status?new REW.FormErrors(this,e.errors):new REW.Notification("danger",e.message)}).on("ajax:before",function(){return $("body").css("cursor","wait"),$("[data-notifications-bar]").empty(),new REW.FormErrors(this,{})}).on("ajax:complete",function(){return $("body").css("cursor","default")})}return t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.RateSuperMarket=function(){function t(t,e){this.$el=$(t),$.extend(this.options,e),$.when(this._getRate("fixed"),this._getRate("variable")).then(function(t){return function(){return t.$el.addClass("is-ready")}}(this))}return t.prototype.options={province:"BC",term:5,amortizationPeriod:25,downpaymentPercentage:.2},t.prototype._getRate=function(t){return $.ajax({url:"https://www.ratesupermarket.ca/api/mortgage_request/",data:{api_key:"4b8bc0e99d8c75655e33c94588d3fcde",num_lenders:1,rate_type:"CLOSED"+t.toUpperCase(),rate_term:this.options.term,amortization_period:this.options.amortizationPeriod,province:this.options.province,mortgage_amount:this._mortgageAmount(),exclude_restrictions:1},dataType:"jsonp",success:function(e){return function(n){var o;return"undefined"!=typeof n[0].rate?(o=n[0].rate[0],e.$el.find("[data-rate-super-market-rate-"+t+"]").html(o.interest_rate),e.$el.find("[data-rate-super-market-link-"+t+"]").attr("href",o.application_page_link)):void 0}}(this)})},t.prototype._mortgageAmount=function(){return this.$el.data("list-price")*(1-this.options.downpaymentPercentage)},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.RedirectTimer=function(t){return $(t).each(function(){var t,e,n;return t=$(this),e=function(n){return n>0?setTimeout(e(n-1),1e3):REW.Redirecter(t.data("target"))},n=parseInt(t.html(),10),setTimeout(e(n),2e3)})},$(function(){return REW.RedirectTimer("[data-redirect-timer]")})}.call(this),function(){null==window.REW&&(window.REW={}),REW.Redirecter=function(t){return window.location=t}}.call(this),function(){null==window.REW&&(window.REW={}),REW.ResponsiveBreakpoints={XS_MAX:767,SM_MIN:768,SM_MAX:991,MD_MIN:992,MD_MAX:1199,LG_MIN:1200}}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.SearchResultsUpdater=function(){function e(e){this._handleResponse=t(this._handleResponse,this),this._handlePageChange=t(this._handlePageChange,this),$.extend(this.options,e),this.$promotedListing=$(this.options.promotedListing),this.$organicListings=$(this.options.organicListings),this.$paginator=$(this.options.paginator),this.$topPaginator=$(this.options.topPaginator),this.setMap(this.options.propertyMap),this._attachEvents()}return e.prototype.options={promotedListing:null,organicListings:null,paginator:null,topPaginator:null,propertyMap:null,onPageChanged:function(){}},e.prototype.setMap=function(t){this.propertyMap=t},e.prototype.goToPage=function(t){return $("body").css("cursor","wait"),$.getJSON(t,{ajax:!0},this._handleResponse.bind(this,t))},e.prototype._attachEvents=function(){return this.$paginator.on("click","a",this._handlePageChange),this.$topPaginator.on("click","a",this._handlePageChange)},e.prototype._handlePageChange=function(t){var e;return t.preventDefault(),t.stopImmediatePropagation(),e=t.currentTarget.href,$(this).trigger("pageChanged",e)},e.prototype._handleResponse=function(t,e){return $("html, body").scrollTop(0),this.$organicListings.html(e.listings),this.$promotedListing.html(e.promoted_listing),this.$paginator.html(e.pagination),this.$topPaginator.html(e.topPagination),$("body").css("cursor","default"),this.options.onPageChanged()},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.SnazzyStyles={BlueWater:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]}]}}.call(this),function(){null==window.REW&&(window.REW={}),REW.StatTracking={track:function(t){var e;return e=$(t).data("tracking-url"),$.post(e)}},$(function(){return $("[data-tracking-url]").on("click",function(){return REW.StatTracking.track(this)})})}.call(this),function(){null==window.REW&&(window.REW={}),REW.TabMenu=function(){function t(t){$.extend(this.options,t),this.$wrapper=$(this.options.wrapper),this.$wrapper.find(this.options.toggle).click(function(t){return function(e){return t._toggleTab(e)}}(this))}return t.prototype.options={backdropClass:"filtersmenu-backdrop","class":"active",content:"[data-tabmenu-content]",section:"[data-tabmenu-section]",toggle:"[data-tabmenu-toggle]",wrapper:"[data-tabmenu]"},t.prototype._changeTab=function(t){return this.closeTabs(),this._openTab(t)},t.prototype.closeTabs=function(){return this.$wrapper.find(this.options.section+","+this.options.content).removeClass(this.options["class"]),this.$activeTab=null,this._removeBackdrop()},t.prototype._openTab=function(t){return t.addClass(this.options["class"]),t.find(this.options.content).addClass(this.options["class"]),this.$activeTab=t.get(0),this._addBackdrop()},t.prototype._addBackdrop=function(){return this.$backdrop=$("<div>",{"class":this.options.backdropClass,on:{click:function(t){return function(){return t.closeTabs()}}(this)}}),$("body").append(this.$backdrop)},t.prototype._removeBackdrop=function(){var t;return null!=(t=this.$backdrop)?t.remove():void 0},t.prototype._toggleTab=function(t){var e,n;return n=$(t.target),e=n.closest(this.options.section),this._tabIsActive(e)?this.closeTabs():this._changeTab(e)},t.prototype._tabIsActive=function(t){return this.$activeTab===t.get(0)},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.Templates=HandlebarsTemplates}.call(this),function(){null==window.REW&&(window.REW={}),REW.TextReplace=function(t,e){var n,o;return n=$(t),o=$(e),n.on("click",function(){return n.remove(),o.each(function(t,e){var n,o;return n=$(e),o=n.data("textreplace-value"),n.html(o)})})},$(function(){return REW.TextReplace("[data-textreplace-trigger]","[data-textreplace-value]")})}.call(this),function(){null==window.REW&&(window.REW={}),REW.ToggleClass=function(){function t(t){$(t).click(function(){var t,e,n;return t=$(this),e=$(t.data("target")),n=t.data("toggle-class"),e.toggleClass(n)})}return t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.ToggleOpenHouseCities=function(){function t(t,e){this.$select=$(t),this.$select.on("change",function(){return $(e).addClass("hidden-xs"),$(e+"[data-group="+this.value+"]").removeClass("hidden-xs")})}return t}()}.call(this),function(){$(function(){return $("body").on("touchstart.dropdown",".dropdown-menu",function(t){return t.stopPropagation()}).on("touchstart.dropdown",".dropdown-submenu",function(t){return t.stopPropagation()})})}.call(this),function(){$(function(){return $("[data-track-agent-phone-contact]").on("shown.bs.modal",function(){return REW.Tracking.agentPhoneContact()})})}.call(this),function(){null==window.REW&&(window.REW={}),REW.Tracking={userSignup:function(){return this._track("User Signup")},mortgageCalculatorClick:function(){return this._track("Mortgage Calculator Click")},mortgageCalculatorBannerClick:function(){return this._track("Mortgage Calculator Banner Click")},mortgageCalculatorHoldClick:function(){return this._track("Mortgage Calculator Hold Rate BT1 Click")},mortgageRateRequest:function(){return this._track("Mortgage Rate Request")},newsletterSignup:function(){return this._track("Newsletter Signup")},mapEnable:function(){return this._track("Search Results Map Enabled")},mapDisable:function(){return this._track("Search Results Map Disabled")},pageView:function(){return this._track("_trackPageview")},agentContact:function(){return this._track("Agent Contact")},agentPhoneContact:function(){return this._track("Agent Phone Contact")},agentCalled:function(){return this._track("Agent Called")},saveSearch:function(){return this._track("Save Search Click")},bookmarkProperty:function(){return this._track("Save Property Click")},unbookmarkProperty:function(){return this._track("Unsave Property Click");
},viewingRequest:function(){return this._track("Viewing Request")},virtualTour:function(){return this._track("Virtual Tour Click")},developmentPhoneClick:function(){return this._track("Dev Phone BT Clicks")},developmentInfoRequest:function(){return this._track("Dev Info Request Submit")},rateSuperMarketClick:function(){return this._track("Rate Super Market Click")},buildingAgentPhoneContact:function(){return this._track("Building Agent Phone Contact")},buildingAgentEmailContact:function(){return this._track("Building Agent Email Contact")},shareByEmail:function(){return this._track("Share By Email")},shareByText:function(){return this._track("Share By Text")},shareByFacebook:function(){return this._track("Share By Facebook BT click")},_track:function(t){return dataLayer.push({event:t}),!0}},$(function(){return $("[data-ga-tracking]").on("click",function(){return REW.Tracking[$(this).data("ga-tracking")]()})})}.call(this),function(){null==window.REW&&(window.REW={}),REW.UrlParamAppender=function(){function t(t,e){null==e&&(e={}),$.extend(this.options,e),this.$links=$(t),this.$links.each(function(t){return function(e,n){return t.addUrlParam(n)}}(this))}return t.prototype.options={attributeName:"link-params"},t.prototype.addUrlParam=function(t){var e,n;return e=$(t),n=e.attr("href").match(/\?/)?"&":"?",n+=e.data(this.options.attributeName),e.attr("href",e.attr("href")+n)},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.VideoReplacer=function(){function t(t){$(t).on("click",function(){var t,e,n,o,a;return t=$(this),o=t.data("video-replace"),a=t.get(0).clientWidth,n=t.get(0).clientHeight,e=$("<iframe allowfullscreen frameborder='0' width="+a+" height="+n+" src='"+o+"'></iframe>"),t.html(e)})}return t}(),$(function(){return new REW.VideoReplacer("[data-video-replace]")})}.call(this),function(){null==window.REW&&(window.REW={}),REW.ViewingRequestForm=function(){function t(t,e){$.extend(this.options,e),this.$form=$(t),this.$datePicker=this.$form.find(this.options.datePickerSelector),this.$datePicker.datepicker({minDate:0,dateFormat:this.options.dateFormat}),new REW.AjaxFormSubmitterWithErrorHandling(this.$form,{onSuccess:this.options.onSuccess,onFailure:this.options.onFailure,successEvent:this.options.successEvent,onBeforeData:function(t){return function(){var e,n;return e=t.$datePicker.val(),n="I would like to request a viewing on "+e,t.$form.find(t.options.messageSelector).val(n)}}(this)})}return t.prototype.options={onSuccess:function(){},onFailure:function(){},successEvent:"viewingRequest",datePickerSelector:"[data-datepicker]",messageSelector:"[data-viewing-request-message]",dateFormat:"D M d, yy"},t}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.VisibilityToggle=function(t){var e;return e=$(t),e.each(function(t,e){var n,o,a;return o=$(e),a=$(o.data("switchoff")),n=$(o.data("switchon")),o.on("click",function(t){return t.preventDefault(),a.hide(),n.show()})})}}.call(this),function(){null==window.REW&&(window.REW={}),REW.VisibleStateToggle=function(){function t(){}return t.setState=function(t,e,n,o){var a;return a={visible:n,id:t,_method:"PUT"},$.post(e,a,o,"json")},t}(),$(function(){return $("[data-visibletoggle]").on("change",function(t){var e,n,o,a;return e=$(this),n=e.data("id"),o=e.data("url"),a=e.prop("checked")?!0:!1,REW.VisibleStateToggle.setState(n,o,a)})})}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};null==window.REW&&(window.REW={}),REW.Walkscore=function(){function e(e){this.url=e,this.score=t(this.score,this)}return e.prototype.score=function(t,e,n){return $.getJSON(this.url,{latitude:t,longitude:e,address:n},function(t){return console.log(t)})},e}()}.call(this),function(){null==window.REW&&(window.REW={}),REW.Yelp=function(){function t(t){this.url=t}return t.prototype.search=function(t,e,n,o){var a;return a={term:t,latitude:e,longitude:n},$.getJSON(this.url,a,function(t,e,n){return o(t)}).error(function(){return console.log(arguments)})},t}()}.call(this),$.cloudinary.config({cloud_name:"grieg",api_key:"922957896833963"}),$.cloudinary.responsive(),function(){$(function(){var t,e,n;return $("#loginForm").on("show.bs.modal",function(){return $("body").removeClass("offcanvas-in")}),$(".navbar--rew, .offcanvas").on("click",".navbar--rew-login_link",function(t){return t.preventDefault(),REW.LoginHandler.loginAndProcess(function(t){return t&&t!==window.location.href?window.location=t:void 0},"#login")}),$(".registrationform").on("click",".registrationform-toggle",function(t){var e;return t.preventDefault(),e=$($(this).data("target")),$(".registrationform-tabs, #password").hide(),e.removeClass("hide").show(),$("#loginForm header h3").html(e.data("title"))}),t=new REW.AjaxFormSubmitter("#login form",{onBeforeSend:function(){return $("#login .alert").hide()},onSuccess:function(t){var e;return e=t.redirect,window.location=e},onError:function(t){return $("#login .registrationform-errors").html(t).removeClass("hide").show()}}),e=new REW.AjaxFormSubmitter("#password form",{onBeforeSend:function(){return $("#password .alert").hide()},onSuccess:function(){var t;return t=$("#password .registrationform-success").html(),new REW.Notification("success",t),$("#loginForm").modal("hide")},onError:function(t,e){var n;return n=Object.keys(e.errors)[0],$("#password .registrationform-errors[data-error='"+n+"']").removeClass("hide").show()}}),n=new REW.AjaxFormSubmitter("#sign_up form",{onBeforeSend:function(){var t;return t=$("#sign_up form"),t.find(".alert").hide(),t.find(".help-block").remove(),t.find(".error").removeClass("error")},onSuccess:function(t){return REW.logged_in=t,REW.Tracking.userSignup(),$(".banner-nav").load("/navigation/show"),$("#loginForm").modal("hide")},onError:function(t,e){var n,o,a,i,r,s,l,h,u,c;o=$("#sign_up form"),u=e.errors,c=[];for(l in u){for(r=u[l],n=o.find('[name="user['+l+']"]'),a=$('<div class="help-block"><ul class="unstyled"></ul></div>'),s=0,h=r.length;h>s;s++)i=r[s],a.find("ul").append("<li>"+i+"</li>");c.push(n.parents(".form-group").addClass("error").append(a))}return c}}),$("#loginForm").on("show",function(){return $(this).find(".alert").hide(),$("#password").hide(),$("#loginForm .registrationform-tabs").show()}),$('#loginForm .nav-tabs a[data-toggle="tab"]').on("shown",function(t){var e,n;return e=$(t.target),$("#loginForm header h3").html(e.html()),n=e.data("blurb"),$("#loginForm .registrationform-blurb").html(n)}),$("[data-modaltabselector-target]").on("click",function(t){var e;return t.preventDefault,e=$(this),REW.ModalTabSelector(e.data("modaltabselector-target"),e.data("modaltabselector-tab"))})})}.call(this),function(){}.call(this);